2020-07-14 21:17:45.823936 (MainThread): Running with dbt=0.17.0
2020-07-14 21:17:46.274409 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-14 21:17:46.277401 (MainThread): Tracking: tracking
2020-07-14 21:17:46.277401 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05873DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x064E9658>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x064E9418>]}
2020-07-14 21:17:46.301470 (MainThread): Partial parsing not enabled
2020-07-14 21:17:46.310444 (MainThread): Parsing macros\core.sql
2020-07-14 21:17:46.318423 (MainThread): Parsing macros\adapters\common.sql
2020-07-14 21:17:46.370285 (MainThread): Parsing macros\etc\datetime.sql
2020-07-14 21:17:46.381294 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-14 21:17:46.386243 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-14 21:17:46.390232 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-14 21:17:46.394246 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-14 21:17:46.398211 (MainThread): Parsing macros\etc\query.sql
2020-07-14 21:17:46.402200 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-14 21:17:46.413443 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-14 21:17:46.428898 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-14 21:17:46.433888 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-14 21:17:46.442864 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-14 21:17:46.468830 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-14 21:17:46.497717 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-14 21:17:46.503701 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-14 21:17:46.521653 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-14 21:17:46.533621 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-14 21:17:46.540602 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-14 21:17:46.549578 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-14 21:17:46.553288 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-14 21:17:46.556279 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-14 21:17:46.559297 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-14 21:17:46.565288 (MainThread): Parsing macros\adapters.sql
2020-07-14 21:17:46.585202 (MainThread): Parsing macros\catalog.sql
2020-07-14 21:17:46.593202 (MainThread): Parsing macros\etc.sql
2020-07-14 21:17:46.597204 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-14 21:17:46.612129 (MainThread): Parsing macros\materializations\seed.sql
2020-07-14 21:17:46.616119 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-14 21:17:46.621105 (MainThread): Parsing macros\materializations\table.sql
2020-07-14 21:17:46.633091 (MainThread): Parsing macros\materializations\view.sql
2020-07-14 21:17:46.657009 (MainThread): Partial parsing not enabled
2020-07-14 21:17:46.691951 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-14 21:17:46.691951 (MainThread): Opening a new connection, currently in state init
2020-07-14 21:17:46.719840 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-14 21:17:46.719840 (MainThread): Opening a new connection, currently in state closed
2020-07-14 21:17:46.966579 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-14 21:17:46.966579 (MainThread): 
2020-07-14 21:17:46.967577 (MainThread): Acquiring new bigquery connection "master".
2020-07-14 21:17:46.967577 (MainThread): Opening a new connection, currently in state closed
2020-07-14 21:17:46.972563 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-14 21:17:46.973562 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-14 21:17:47.493459 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_bigquery-dbt_dbt_lucas".
2020-07-14 21:17:47.493459 (ThreadPoolExecutor-0_0): Re-using an available connection from the pool (formerly list_bigquery-dbt).
2020-07-14 21:17:47.493459 (ThreadPoolExecutor-0_0): Creating schema "bigquery-dbt.dbt_lucas".
2020-07-14 21:17:47.494459 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-14 21:17:47.904628 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-14 21:17:47.904628 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-14 21:17:47.905627 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-14 21:17:48.361759 (MainThread): Acquiring new bigquery connection "master".
2020-07-14 21:17:48.362755 (MainThread): Opening a new connection, currently in state closed
2020-07-14 21:17:48.363754 (MainThread): 18:17:48 | Concurrency: 1 threads (target='dev')
2020-07-14 21:17:48.364696 (MainThread): 18:17:48 | 
2020-07-14 21:17:48.410005 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-07-14 21:17:48.411006 (Thread-1): 18:17:48 | 1 of 2 START table model dbt_lucas.my_first_dbt_model................ [RUN]
2020-07-14 21:17:48.412003 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-14 21:17:48.412003 (Thread-1): Opening a new connection, currently in state init
2020-07-14 21:17:48.413001 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-07-14 21:17:48.435938 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-14 21:17:48.441922 (Thread-1): finished collecting timing info
2020-07-14 21:17:48.477861 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-14 21:17:48.483811 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-07-14 21:17:51.214498 (Thread-1): finished collecting timing info
2020-07-14 21:17:51.216499 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e472f8-8928-4bf2-87df-6c836b3f34e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06652268>]}
2020-07-14 21:17:51.218467 (Thread-1): 18:17:51 | 1 of 2 OK created table model dbt_lucas.my_first_dbt_model........... [CREATE TABLE (2) in 2.80s]
2020-07-14 21:17:51.219444 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-07-14 21:17:51.220439 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-07-14 21:17:51.222479 (Thread-1): 18:17:51 | 2 of 2 START view model dbt_lucas.my_second_dbt_model................ [RUN]
2020-07-14 21:17:51.223431 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-14 21:17:51.223431 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model).
2020-07-14 21:17:51.223431 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-07-14 21:17:51.233438 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-14 21:17:51.237393 (Thread-1): finished collecting timing info
2020-07-14 21:17:51.254385 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-14 21:17:51.258374 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
where id = 1;


2020-07-14 21:17:52.169463 (Thread-1): finished collecting timing info
2020-07-14 21:17:52.171456 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20e472f8-8928-4bf2-87df-6c836b3f34e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0662FA48>]}
2020-07-14 21:17:52.173454 (Thread-1): 18:17:52 | 2 of 2 OK created view model dbt_lucas.my_second_dbt_model........... [CREATE VIEW in 0.95s]
2020-07-14 21:17:52.175404 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-07-14 21:17:52.176416 (MainThread): Acquiring new bigquery connection "master".
2020-07-14 21:17:52.177396 (MainThread): Opening a new connection, currently in state closed
2020-07-14 21:17:52.177396 (MainThread): 18:17:52 | 
2020-07-14 21:17:52.177396 (MainThread): 18:17:52 | Finished running 1 table model, 1 view model in 5.21s.
2020-07-14 21:17:52.178398 (MainThread): Connection 'master' was properly closed.
2020-07-14 21:17:52.178398 (MainThread): Connection 'create_bigquery-dbt_dbt_lucas' was left open.
2020-07-14 21:17:52.178398 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-14 21:17:52.178398 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was left open.
2020-07-14 21:17:52.195349 (MainThread): 
2020-07-14 21:17:52.195349 (MainThread): Completed successfully
2020-07-14 21:17:52.196346 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-14 21:17:52.199362 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0662AFB8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0662AEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0662AE50>]}
2020-07-14 21:17:52.199362 (MainThread): Flushing usage events
2020-07-15 01:15:53.393482 (MainThread): Running with dbt=0.17.0
2020-07-15 01:15:54.705685 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 01:15:54.708692 (MainThread): Tracking: tracking
2020-07-15 01:15:54.710691 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x058F3DD8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0656A748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0656A790>]}
2020-07-15 01:15:54.767229 (MainThread): Partial parsing not enabled
2020-07-15 01:15:54.787161 (MainThread): Parsing macros\core.sql
2020-07-15 01:15:54.805084 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 01:15:54.876893 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 01:15:54.892806 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 01:15:54.897792 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 01:15:54.902781 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 01:15:54.908764 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 01:15:54.913778 (MainThread): Parsing macros\etc\query.sql
2020-07-15 01:15:54.919736 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 01:15:54.940719 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 01:15:54.978277 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 01:15:54.984229 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 01:15:54.999204 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 01:15:55.035091 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 01:15:55.069001 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 01:15:55.076016 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 01:15:55.097923 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 01:15:55.108894 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 01:15:55.120219 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 01:15:55.131876 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 01:15:55.137776 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 01:15:55.141394 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 01:15:55.146433 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 01:15:55.154327 (MainThread): Parsing macros\adapters.sql
2020-07-15 01:15:55.180258 (MainThread): Parsing macros\catalog.sql
2020-07-15 01:15:55.193577 (MainThread): Parsing macros\etc.sql
2020-07-15 01:15:55.201252 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 01:15:55.227131 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 01:15:55.232126 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 01:15:55.239661 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 01:15:55.261311 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 01:15:55.312854 (MainThread): Partial parsing not enabled
2020-07-15 01:15:55.396685 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 01:15:55.396685 (MainThread): Opening a new connection, currently in state init
2020-07-15 01:15:55.434526 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 01:15:55.434526 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:15:55.451480 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 01:15:55.451480 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:15:55.841105 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 01:15:55.843104 (MainThread): 
2020-07-15 01:15:55.847150 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:15:55.847150 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:15:55.864102 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 01:15:55.865145 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 01:15:57.098156 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 01:15:57.099058 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 01:15:57.102049 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:15:57.844925 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:15:57.844925 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:15:57.844925 (MainThread): 22:15:57 | Concurrency: 1 threads (target='dev')
2020-07-15 01:15:57.846271 (MainThread): 22:15:57 | 
2020-07-15 01:15:57.875969 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-07-15 01:15:57.878074 (Thread-1): 22:15:57 | 1 of 3 START table model dbt_lucas.my_first_dbt_model................ [RUN]
2020-07-15 01:15:57.879142 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 01:15:57.879142 (Thread-1): Opening a new connection, currently in state init
2020-07-15 01:15:57.879954 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-07-15 01:15:57.918883 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 01:15:57.925834 (Thread-1): finished collecting timing info
2020-07-15 01:15:57.959790 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:15:58.595550 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 01:15:58.602533 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-07-15 01:16:00.927647 (Thread-1): finished collecting timing info
2020-07-15 01:16:00.929471 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b5825-6de4-45af-98b8-a085d80f7389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066CB208>]}
2020-07-15 01:16:00.932512 (Thread-1): 22:16:00 | 1 of 3 OK created table model dbt_lucas.my_first_dbt_model........... [CREATE TABLE (2) in 3.05s]
2020-07-15 01:16:00.933454 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-07-15 01:16:00.934532 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 01:16:00.936496 (Thread-1): 22:16:00 | 2 of 3 START view model dbt_lucas.customers.......................... [RUN]
2020-07-15 01:16:00.937486 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 01:16:00.937486 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model).
2020-07-15 01:16:00.937486 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 01:16:00.950412 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 01:16:00.957392 (Thread-1): finished collecting timing info
2020-07-15 01:16:00.990301 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 01:16:00.996294 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-07-15 01:16:02.350208 (Thread-1): finished collecting timing info
2020-07-15 01:16:02.352144 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b5825-6de4-45af-98b8-a085d80f7389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066F9D90>]}
2020-07-15 01:16:02.353142 (Thread-1): 22:16:02 | 2 of 3 OK created view model dbt_lucas.customers..................... [CREATE VIEW in 1.41s]
2020-07-15 01:16:02.355133 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 01:16:02.355133 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-07-15 01:16:02.357179 (Thread-1): 22:16:02 | 3 of 3 START view model dbt_lucas.my_second_dbt_model................ [RUN]
2020-07-15 01:16:02.358127 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 01:16:02.358127 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.customers).
2020-07-15 01:16:02.359159 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-07-15 01:16:02.370133 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 01:16:02.375081 (Thread-1): finished collecting timing info
2020-07-15 01:16:02.381103 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 01:16:02.385303 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
where id = 1;


2020-07-15 01:16:03.386454 (Thread-1): finished collecting timing info
2020-07-15 01:16:03.389447 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b5825-6de4-45af-98b8-a085d80f7389', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066A00E8>]}
2020-07-15 01:16:03.393381 (Thread-1): 22:16:03 | 3 of 3 OK created view model dbt_lucas.my_second_dbt_model........... [CREATE VIEW in 1.03s]
2020-07-15 01:16:03.395982 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-07-15 01:16:03.398491 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:16:03.398491 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:16:03.399488 (MainThread): 22:16:03 | 
2020-07-15 01:16:03.400003 (MainThread): 22:16:03 | Finished running 1 table model, 2 view models in 7.55s.
2020-07-15 01:16:03.400918 (MainThread): Connection 'master' was properly closed.
2020-07-15 01:16:03.401087 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 01:16:03.401087 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 01:16:03.401087 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was left open.
2020-07-15 01:16:03.439842 (MainThread): 
2020-07-15 01:16:03.440824 (MainThread): Completed successfully
2020-07-15 01:16:03.445958 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 01:16:03.446794 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066B40D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066B2250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066CB958>]}
2020-07-15 01:16:03.446794 (MainThread): Flushing usage events
2020-07-15 01:21:29.087327 (MainThread): Running with dbt=0.17.0
2020-07-15 01:21:30.117187 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 01:21:30.120181 (MainThread): Tracking: tracking
2020-07-15 01:21:30.121178 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05933D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AA880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AA898>]}
2020-07-15 01:21:30.171049 (MainThread): Partial parsing not enabled
2020-07-15 01:21:30.180021 (MainThread): Parsing macros\core.sql
2020-07-15 01:21:30.187003 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 01:21:30.243899 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 01:21:30.270831 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 01:21:30.275881 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 01:21:30.281937 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 01:21:30.288849 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 01:21:30.294826 (MainThread): Parsing macros\etc\query.sql
2020-07-15 01:21:30.299813 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 01:21:30.323748 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 01:21:30.357663 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 01:21:30.361654 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 01:21:30.376641 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 01:21:30.413004 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 01:21:30.445478 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 01:21:30.449459 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 01:21:30.487311 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 01:21:30.500361 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 01:21:30.513305 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 01:21:30.533193 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 01:21:30.539210 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 01:21:30.543204 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 01:21:30.547156 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 01:21:30.553136 (MainThread): Parsing macros\adapters.sql
2020-07-15 01:21:30.577638 (MainThread): Parsing macros\catalog.sql
2020-07-15 01:21:30.586635 (MainThread): Parsing macros\etc.sql
2020-07-15 01:21:30.588594 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 01:21:30.611532 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 01:21:30.615524 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 01:21:30.619552 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 01:21:30.637463 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 01:21:30.678514 (MainThread): Partial parsing not enabled
2020-07-15 01:21:30.727064 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 01:21:30.727064 (MainThread): Opening a new connection, currently in state init
2020-07-15 01:21:30.762005 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 01:21:30.762005 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:21:30.782628 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 01:21:30.782628 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:21:31.133985 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 01:21:31.136261 (MainThread): 
2020-07-15 01:21:31.137980 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:21:31.139028 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:21:31.150944 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 01:21:31.150944 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 01:21:32.002411 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 01:21:32.003756 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 01:21:32.005433 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:21:32.495973 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:21:32.496992 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:21:32.497987 (MainThread): 22:21:32 | Concurrency: 1 threads (target='dev')
2020-07-15 01:21:32.499109 (MainThread): 22:21:32 | 
2020-07-15 01:21:32.526373 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-07-15 01:21:32.530896 (Thread-1): 22:21:32 | 1 of 3 START table model dbt_lucas.my_first_dbt_model................ [RUN]
2020-07-15 01:21:32.533000 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 01:21:32.533851 (Thread-1): Opening a new connection, currently in state init
2020-07-15 01:21:32.533851 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-07-15 01:21:32.575769 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 01:21:32.582714 (Thread-1): finished collecting timing info
2020-07-15 01:21:32.612217 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:21:33.553909 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 01:21:33.559496 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-07-15 01:21:35.978816 (Thread-1): finished collecting timing info
2020-07-15 01:21:35.980811 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef282a1-23b3-4f55-aa6a-7cf82d29e7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066C2940>]}
2020-07-15 01:21:35.982804 (Thread-1): 22:21:35 | 1 of 3 OK created table model dbt_lucas.my_first_dbt_model........... [CREATE TABLE (2) in 3.45s]
2020-07-15 01:21:35.984977 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-07-15 01:21:35.984977 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 01:21:35.986920 (Thread-1): 22:21:35 | 2 of 3 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 01:21:35.988962 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 01:21:35.989419 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model).
2020-07-15 01:21:35.989419 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 01:21:36.001964 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 01:21:36.011856 (Thread-1): finished collecting timing info
2020-07-15 01:21:36.019883 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:21:36.270194 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:21:36.480456 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 01:21:36.496123 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 01:21:39.134801 (Thread-1): finished collecting timing info
2020-07-15 01:21:39.136842 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef282a1-23b3-4f55-aa6a-7cf82d29e7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06708070>]}
2020-07-15 01:21:39.141827 (Thread-1): 22:21:39 | 2 of 3 OK created table model dbt_lucas.customers.................... [CREATE TABLE (100) in 3.15s]
2020-07-15 01:21:39.144784 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 01:21:39.144784 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-07-15 01:21:39.151801 (Thread-1): 22:21:39 | 3 of 3 START view model dbt_lucas.my_second_dbt_model................ [RUN]
2020-07-15 01:21:39.153748 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 01:21:39.155212 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.customers).
2020-07-15 01:21:39.155212 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-07-15 01:21:39.184669 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 01:21:39.191650 (Thread-1): finished collecting timing info
2020-07-15 01:21:39.222599 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 01:21:39.230544 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
where id = 1;


2020-07-15 01:21:40.020563 (Thread-1): finished collecting timing info
2020-07-15 01:21:40.022773 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ef282a1-23b3-4f55-aa6a-7cf82d29e7cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06700190>]}
2020-07-15 01:21:40.026152 (Thread-1): 22:21:40 | 3 of 3 OK created view model dbt_lucas.my_second_dbt_model........... [CREATE VIEW in 0.87s]
2020-07-15 01:21:40.028145 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-07-15 01:21:40.031104 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:21:40.031104 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:21:40.032103 (MainThread): 22:21:40 | 
2020-07-15 01:21:40.032103 (MainThread): 22:21:40 | Finished running 2 table models, 1 view model in 8.89s.
2020-07-15 01:21:40.033097 (MainThread): Connection 'master' was properly closed.
2020-07-15 01:21:40.034142 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 01:21:40.034142 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 01:21:40.034142 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was left open.
2020-07-15 01:21:40.061025 (MainThread): 
2020-07-15 01:21:40.062104 (MainThread): Completed successfully
2020-07-15 01:21:40.064016 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 01:21:40.065052 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066FB928>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0673E910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06788BE0>]}
2020-07-15 01:21:40.065052 (MainThread): Flushing usage events
2020-07-15 01:24:24.480935 (MainThread): Running with dbt=0.17.0
2020-07-15 01:24:25.531775 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 01:24:25.534801 (MainThread): Tracking: tracking
2020-07-15 01:24:25.535806 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05933DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AD820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AD8E0>]}
2020-07-15 01:24:25.591651 (MainThread): Partial parsing not enabled
2020-07-15 01:24:25.610067 (MainThread): Parsing macros\core.sql
2020-07-15 01:24:25.622191 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 01:24:25.682549 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 01:24:25.694518 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 01:24:25.697504 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 01:24:25.700857 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 01:24:25.703871 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 01:24:25.706805 (MainThread): Parsing macros\etc\query.sql
2020-07-15 01:24:25.709848 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 01:24:25.732739 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 01:24:25.767643 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 01:24:25.772633 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 01:24:25.782606 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 01:24:25.825087 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 01:24:25.867976 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 01:24:25.870966 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 01:24:25.889960 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 01:24:25.910861 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 01:24:25.921829 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 01:24:25.930826 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 01:24:25.934851 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 01:24:25.937810 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 01:24:25.939806 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 01:24:25.943791 (MainThread): Parsing macros\adapters.sql
2020-07-15 01:24:25.962279 (MainThread): Parsing macros\catalog.sql
2020-07-15 01:24:25.970268 (MainThread): Parsing macros\etc.sql
2020-07-15 01:24:25.973217 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 01:24:26.006972 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 01:24:26.012952 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 01:24:26.018970 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 01:24:26.049905 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 01:24:26.113682 (MainThread): Partial parsing not enabled
2020-07-15 01:24:26.187524 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 01:24:26.188520 (MainThread): Opening a new connection, currently in state init
2020-07-15 01:24:26.220438 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 01:24:26.220438 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:24:26.234396 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 01:24:26.234396 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:24:26.548271 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 01:24:26.550265 (MainThread): 
2020-07-15 01:24:26.552259 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:24:26.552259 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:24:26.565227 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 01:24:26.566228 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 01:24:27.414578 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 01:24:27.414578 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 01:24:27.416518 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:24:27.986464 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:24:27.987509 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:24:27.988510 (MainThread): 22:24:27 | Concurrency: 1 threads (target='dev')
2020-07-15 01:24:27.989468 (MainThread): 22:24:27 | 
2020-07-15 01:24:28.014403 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-07-15 01:24:28.018378 (Thread-1): 22:24:28 | 1 of 3 START table model dbt_lucas.my_first_dbt_model................ [RUN]
2020-07-15 01:24:28.019438 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 01:24:28.020419 (Thread-1): Opening a new connection, currently in state init
2020-07-15 01:24:28.020419 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-07-15 01:24:28.060220 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 01:24:28.068162 (Thread-1): finished collecting timing info
2020-07-15 01:24:28.115036 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:24:28.826506 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 01:24:28.834538 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-07-15 01:24:31.496787 (Thread-1): finished collecting timing info
2020-07-15 01:24:31.498783 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9d830cf-7aa0-4a6c-b73a-5762c6e96daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06703DF0>]}
2020-07-15 01:24:31.500776 (Thread-1): 22:24:31 | 1 of 3 OK created table model dbt_lucas.my_first_dbt_model........... [CREATE TABLE (2) in 3.48s]
2020-07-15 01:24:31.501774 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-07-15 01:24:31.502771 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 01:24:31.504810 (Thread-1): 22:24:31 | 2 of 3 START view model dbt_lucas.customers.......................... [RUN]
2020-07-15 01:24:31.505763 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 01:24:31.505763 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model).
2020-07-15 01:24:31.505763 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 01:24:31.520770 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 01:24:31.527705 (Thread-1): finished collecting timing info
2020-07-15 01:24:31.563649 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:24:31.900471 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 01:24:31.913436 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-07-15 01:24:33.122211 (Thread-1): finished collecting timing info
2020-07-15 01:24:33.124207 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9d830cf-7aa0-4a6c-b73a-5762c6e96daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067398B0>]}
2020-07-15 01:24:33.127192 (Thread-1): 22:24:33 | 2 of 3 OK created view model dbt_lucas.customers..................... [CREATE VIEW in 1.62s]
2020-07-15 01:24:33.129137 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 01:24:33.129334 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-07-15 01:24:33.132181 (Thread-1): 22:24:33 | 3 of 3 START view model dbt_lucas.my_second_dbt_model................ [RUN]
2020-07-15 01:24:33.132181 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 01:24:33.133318 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.customers).
2020-07-15 01:24:33.133318 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-07-15 01:24:33.149154 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 01:24:33.157059 (Thread-1): finished collecting timing info
2020-07-15 01:24:33.163076 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 01:24:33.170023 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
where id = 1;


2020-07-15 01:24:34.357186 (Thread-1): finished collecting timing info
2020-07-15 01:24:34.360179 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9d830cf-7aa0-4a6c-b73a-5762c6e96daa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066D5F28>]}
2020-07-15 01:24:34.364168 (Thread-1): 22:24:34 | 3 of 3 OK created view model dbt_lucas.my_second_dbt_model........... [CREATE VIEW in 1.23s]
2020-07-15 01:24:34.366617 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-07-15 01:24:34.370098 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:24:34.370098 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:24:34.371182 (MainThread): 22:24:34 | 
2020-07-15 01:24:34.372093 (MainThread): 22:24:34 | Finished running 1 table model, 2 view models in 7.82s.
2020-07-15 01:24:34.374040 (MainThread): Connection 'master' was properly closed.
2020-07-15 01:24:34.374279 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 01:24:34.374279 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 01:24:34.375168 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was left open.
2020-07-15 01:24:34.422903 (MainThread): 
2020-07-15 01:24:34.423957 (MainThread): Completed successfully
2020-07-15 01:24:34.428887 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 01:24:34.429969 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06703748>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06703E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06703FD0>]}
2020-07-15 01:24:34.429969 (MainThread): Flushing usage events
2020-07-15 01:26:13.825338 (MainThread): Running with dbt=0.17.0
2020-07-15 01:26:14.743488 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 01:26:14.746385 (MainThread): Tracking: tracking
2020-07-15 01:26:14.747328 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05933DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AB670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AB6A0>]}
2020-07-15 01:26:14.778191 (MainThread): Partial parsing not enabled
2020-07-15 01:26:14.788729 (MainThread): Parsing macros\core.sql
2020-07-15 01:26:14.796740 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 01:26:14.861539 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 01:26:14.874548 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 01:26:14.877017 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 01:26:14.884604 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 01:26:14.891628 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 01:26:14.898697 (MainThread): Parsing macros\etc\query.sql
2020-07-15 01:26:14.903552 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 01:26:14.924494 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 01:26:14.948430 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 01:26:14.953423 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 01:26:14.966433 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 01:26:14.996357 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 01:26:15.031208 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 01:26:15.035210 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 01:26:15.056142 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 01:26:15.067161 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 01:26:15.084184 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 01:26:15.105025 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 01:26:15.114000 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 01:26:15.117990 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 01:26:15.123181 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 01:26:15.132950 (MainThread): Parsing macros\adapters.sql
2020-07-15 01:26:15.169889 (MainThread): Parsing macros\catalog.sql
2020-07-15 01:26:15.180821 (MainThread): Parsing macros\etc.sql
2020-07-15 01:26:15.182816 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 01:26:15.198925 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 01:26:15.201803 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 01:26:15.204771 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 01:26:15.220720 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 01:26:15.255377 (MainThread): Partial parsing not enabled
2020-07-15 01:26:15.294272 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 01:26:15.294272 (MainThread): Opening a new connection, currently in state init
2020-07-15 01:26:15.323265 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 01:26:15.323265 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:26:15.337191 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 01:26:15.337191 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:26:15.635803 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 01:26:15.637796 (MainThread): 
2020-07-15 01:26:15.638793 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:26:15.639833 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:26:15.653755 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 01:26:15.654751 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 01:26:16.474359 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 01:26:16.475331 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 01:26:16.477303 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:26:16.954944 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:26:16.954944 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:26:16.955969 (MainThread): 22:26:16 | Concurrency: 1 threads (target='dev')
2020-07-15 01:26:16.956893 (MainThread): 22:26:16 | 
2020-07-15 01:26:16.971888 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-07-15 01:26:16.973892 (Thread-1): 22:26:16 | 1 of 3 START table model dbt_lucas.my_first_dbt_model................ [RUN]
2020-07-15 01:26:16.974843 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 01:26:16.974949 (Thread-1): Opening a new connection, currently in state init
2020-07-15 01:26:16.974949 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-07-15 01:26:17.004011 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 01:26:17.047201 (Thread-1): finished collecting timing info
2020-07-15 01:26:17.073827 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:26:17.598448 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 01:26:17.605396 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-07-15 01:26:19.918894 (Thread-1): finished collecting timing info
2020-07-15 01:26:19.920890 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a025b28-242c-49c9-a14e-10db4737f68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067380B8>]}
2020-07-15 01:26:19.923835 (Thread-1): 22:26:19 | 1 of 3 OK created table model dbt_lucas.my_first_dbt_model........... [CREATE TABLE (2) in 2.95s]
2020-07-15 01:26:19.924834 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-07-15 01:26:19.924834 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 01:26:19.926825 (Thread-1): 22:26:19 | 2 of 3 START view model dbt_lucas.customers.......................... [RUN]
2020-07-15 01:26:19.927824 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 01:26:19.927824 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model).
2020-07-15 01:26:19.928856 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 01:26:19.941824 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 01:26:19.949763 (Thread-1): finished collecting timing info
2020-07-15 01:26:19.980682 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 01:26:19.986664 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-07-15 01:26:21.268395 (Thread-1): finished collecting timing info
2020-07-15 01:26:21.271337 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a025b28-242c-49c9-a14e-10db4737f68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067383D0>]}
2020-07-15 01:26:21.275319 (Thread-1): 22:26:21 | 2 of 3 OK created view model dbt_lucas.customers..................... [CREATE VIEW in 1.34s]
2020-07-15 01:26:21.277317 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 01:26:21.278359 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-07-15 01:26:21.281306 (Thread-1): 22:26:21 | 3 of 3 START table model dbt_lucas.my_second_dbt_model............... [RUN]
2020-07-15 01:26:21.282365 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 01:26:21.282365 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.customers).
2020-07-15 01:26:21.282365 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-07-15 01:26:21.301248 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 01:26:21.308912 (Thread-1): finished collecting timing info
2020-07-15 01:26:21.315844 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:26:21.555056 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 01:26:21.759894 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 01:26:21.768875 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_second_dbt_model`
  
  
  OPTIONS()
  as (
    -- Use the `ref` function to select from other models

select *
from `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
where id = 1
  );
    
2020-07-15 01:26:23.922338 (Thread-1): finished collecting timing info
2020-07-15 01:26:23.924213 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a025b28-242c-49c9-a14e-10db4737f68c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066BD640>]}
2020-07-15 01:26:23.929254 (Thread-1): 22:26:23 | 3 of 3 OK created table model dbt_lucas.my_second_dbt_model.......... [CREATE TABLE (1) in 2.64s]
2020-07-15 01:26:23.932224 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-07-15 01:26:23.937179 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 01:26:23.938175 (MainThread): Opening a new connection, currently in state closed
2020-07-15 01:26:23.939171 (MainThread): 22:26:23 | 
2020-07-15 01:26:23.941162 (MainThread): 22:26:23 | Finished running 2 table models, 1 view model in 8.30s.
2020-07-15 01:26:23.942161 (MainThread): Connection 'master' was properly closed.
2020-07-15 01:26:23.942161 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 01:26:23.942161 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 01:26:23.943199 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was left open.
2020-07-15 01:26:23.984000 (MainThread): 
2020-07-15 01:26:23.985046 (MainThread): Completed successfully
2020-07-15 01:26:23.987992 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 01:26:23.989984 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066BD4A8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066BD400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066BD3D0>]}
2020-07-15 01:26:23.990984 (MainThread): Flushing usage events
2020-07-15 02:15:09.011438 (MainThread): Running with dbt=0.17.0
2020-07-15 02:15:09.922660 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:15:09.925622 (MainThread): Tracking: tracking
2020-07-15 02:15:09.926620 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06454DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x070C9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x070C9730>]}
2020-07-15 02:15:09.984460 (MainThread): Partial parsing not enabled
2020-07-15 02:15:10.004116 (MainThread): Parsing macros\core.sql
2020-07-15 02:15:10.016086 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:15:10.081449 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:15:10.093416 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:15:10.095413 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:15:10.101395 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:15:10.107383 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:15:10.113366 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:15:10.117356 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:15:10.134309 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:15:10.157236 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:15:10.161228 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:15:10.171201 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:15:10.202115 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:15:10.232035 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:15:10.235334 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:15:10.253976 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:15:10.266993 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:15:10.272926 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:15:10.280905 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:15:10.283896 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:15:10.285890 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:15:10.287886 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:15:10.293928 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:15:10.338847 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:15:10.356701 (MainThread): Parsing macros\etc.sql
2020-07-15 02:15:10.360733 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:15:10.390751 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:15:10.393659 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:15:10.396595 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:15:10.407878 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:15:10.436490 (MainThread): Partial parsing not enabled
2020-07-15 02:15:10.511344 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:15:10.511344 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:15:10.548188 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 02:15:10.549185 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:15:10.559534 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 02:15:10.560539 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:15:10.840778 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:15:10.841949 (MainThread): 
2020-07-15 02:15:10.842741 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:15:10.842741 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:15:10.847727 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:15:10.848768 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:15:11.547118 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:15:11.547118 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:15:11.550015 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:15:11.979827 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:15:11.979827 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:15:11.980821 (MainThread): 23:15:11 | Concurrency: 1 threads (target='dev')
2020-07-15 02:15:11.981822 (MainThread): 23:15:11 | 
2020-07-15 02:15:12.011724 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-07-15 02:15:12.014717 (Thread-1): 23:15:12 | 1 of 3 START table model dbt_lucas.my_first_dbt_model................ [RUN]
2020-07-15 02:15:12.016676 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 02:15:12.016676 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:15:12.016676 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-07-15 02:15:12.043638 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 02:15:12.050579 (Thread-1): finished collecting timing info
2020-07-15 02:15:12.078615 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:15:12.723415 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 02:15:12.731195 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-07-15 02:15:14.744999 (Thread-1): finished collecting timing info
2020-07-15 02:15:14.745994 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6513924-50f4-4c59-983f-ffd9478bd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x071C3028>]}
2020-07-15 02:15:14.748991 (Thread-1): 23:15:14 | 1 of 3 OK created table model dbt_lucas.my_first_dbt_model........... [CREATE TABLE (2) in 2.73s]
2020-07-15 02:15:14.749937 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-07-15 02:15:14.750937 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:15:14.752977 (Thread-1): 23:15:14 | 2 of 3 START view model dbt_lucas.customers.......................... [RUN]
2020-07-15 02:15:14.754265 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:15:14.754265 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model).
2020-07-15 02:15:14.754928 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:15:14.770884 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:15:14.779868 (Thread-1): finished collecting timing info
2020-07-15 02:15:14.811771 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:15:14.821215 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-07-15 02:15:15.967137 (Thread-1): finished collecting timing info
2020-07-15 02:15:15.969133 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6513924-50f4-4c59-983f-ffd9478bd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07211718>]}
2020-07-15 02:15:15.973121 (Thread-1): 23:15:15 | 2 of 3 OK created view model dbt_lucas.customers..................... [CREATE VIEW in 1.21s]
2020-07-15 02:15:15.976106 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:15:15.977107 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-07-15 02:15:15.982230 (Thread-1): 23:15:15 | 3 of 3 START table model dbt_lucas.my_second_dbt_model............... [RUN]
2020-07-15 02:15:15.983189 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 02:15:15.984187 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.customers).
2020-07-15 02:15:15.984187 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-07-15 02:15:16.005124 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 02:15:16.011105 (Thread-1): finished collecting timing info
2020-07-15 02:15:16.017136 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:15:16.260126 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 02:15:16.272088 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_second_dbt_model`
  
  
  OPTIONS()
  as (
    -- Use the `ref` function to select from other models

select *
from `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
where id = 1
  );
    
2020-07-15 02:15:18.723158 (Thread-1): finished collecting timing info
2020-07-15 02:15:18.725209 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6513924-50f4-4c59-983f-ffd9478bd616', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07211EC8>]}
2020-07-15 02:15:18.730175 (Thread-1): 23:15:18 | 3 of 3 OK created table model dbt_lucas.my_second_dbt_model.......... [CREATE TABLE (1) in 2.74s]
2020-07-15 02:15:18.733133 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-07-15 02:15:18.736118 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:15:18.737115 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:15:18.738112 (MainThread): 23:15:18 | 
2020-07-15 02:15:18.739216 (MainThread): 23:15:18 | Finished running 2 table models, 1 view model in 7.90s.
2020-07-15 02:15:18.741104 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:15:18.741104 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:15:18.742101 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:15:18.742209 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was left open.
2020-07-15 02:15:18.783990 (MainThread): 
2020-07-15 02:15:18.784706 (MainThread): Completed successfully
2020-07-15 02:15:18.786979 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 02:15:18.789971 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x071C3028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x072A1E98>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07257CB8>]}
2020-07-15 02:15:18.789971 (MainThread): Flushing usage events
2020-07-15 02:16:11.886493 (MainThread): Running with dbt=0.17.0
2020-07-15 02:16:12.876299 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:16:12.879301 (MainThread): Tracking: tracking
2020-07-15 02:16:12.880253 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05933D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065A9628>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065A9730>]}
2020-07-15 02:16:12.908568 (MainThread): Partial parsing not enabled
2020-07-15 02:16:12.928027 (MainThread): Parsing macros\core.sql
2020-07-15 02:16:12.940991 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:16:13.019779 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:16:13.029759 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:16:13.031749 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:16:13.034742 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:16:13.037733 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:16:13.041730 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:16:13.045715 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:16:13.063664 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:16:13.078622 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:16:13.081614 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:16:13.089632 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:16:13.114597 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:16:13.146493 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:16:13.149472 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:16:13.170440 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:16:13.187437 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:16:13.198408 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:16:13.210745 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:16:13.215365 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:16:13.217324 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:16:13.221312 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:16:13.229333 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:16:13.259208 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:16:13.266189 (MainThread): Parsing macros\etc.sql
2020-07-15 02:16:13.268184 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:16:13.284141 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:16:13.287133 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:16:13.291121 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:16:13.319046 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:16:13.359995 (MainThread): Partial parsing not enabled
2020-07-15 02:16:13.410842 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:16:13.411837 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:16:13.448755 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 02:16:13.449768 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:16:13.478621 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 02:16:13.478621 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:16:13.810854 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:16:13.812847 (MainThread): 
2020-07-15 02:16:13.813843 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:16:13.813843 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:16:13.824813 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:16:13.824813 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:16:14.745414 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:16:14.746581 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:16:14.748401 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:16:15.355504 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:16:15.355504 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:16:15.356503 (MainThread): 23:16:15 | Concurrency: 1 threads (target='dev')
2020-07-15 02:16:15.358128 (MainThread): 23:16:15 | 
2020-07-15 02:16:15.381448 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-07-15 02:16:15.386428 (Thread-1): 23:16:15 | 1 of 3 START table model dbt_lucas.my_first_dbt_model................ [RUN]
2020-07-15 02:16:15.388424 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-07-15 02:16:15.388424 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:16:15.389379 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-07-15 02:16:15.419331 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 02:16:15.463172 (Thread-1): finished collecting timing info
2020-07-15 02:16:15.486240 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:16:16.228845 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-07-15 02:16:16.235791 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-07-15 02:16:19.155759 (Thread-1): finished collecting timing info
2020-07-15 02:16:19.157754 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7705b5-675a-47ec-b265-ec525e82fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067380B8>]}
2020-07-15 02:16:19.160741 (Thread-1): 23:16:19 | 1 of 3 OK created table model dbt_lucas.my_first_dbt_model........... [CREATE TABLE (2) in 3.77s]
2020-07-15 02:16:19.162735 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-07-15 02:16:19.163735 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:16:19.165727 (Thread-1): 23:16:19 | 2 of 3 START view model dbt_lucas.customers.......................... [RUN]
2020-07-15 02:16:19.167721 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:16:19.167721 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.my_first_dbt_model).
2020-07-15 02:16:19.167721 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:16:19.183726 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:16:19.191654 (Thread-1): finished collecting timing info
2020-07-15 02:16:19.228593 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:16:19.236536 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-07-15 02:16:20.175742 (Thread-1): finished collecting timing info
2020-07-15 02:16:20.177738 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7705b5-675a-47ec-b265-ec525e82fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06738370>]}
2020-07-15 02:16:20.181727 (Thread-1): 23:16:20 | 2 of 3 OK created view model dbt_lucas.customers..................... [CREATE VIEW in 1.01s]
2020-07-15 02:16:20.182728 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:16:20.183821 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-07-15 02:16:20.185715 (Thread-1): 23:16:20 | 3 of 3 START table model dbt_lucas.my_second_dbt_model............... [RUN]
2020-07-15 02:16:20.186714 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-07-15 02:16:20.186714 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.customers).
2020-07-15 02:16:20.186714 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-07-15 02:16:20.195689 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 02:16:20.239820 (Thread-1): finished collecting timing info
2020-07-15 02:16:20.245941 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:16:20.464794 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-07-15 02:16:20.475766 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`my_second_dbt_model`
  
  
  OPTIONS()
  as (
    -- Use the `ref` function to select from other models

select *
from `bigquery-dbt`.`dbt_lucas`.`my_first_dbt_model`
where id = 1
  );
    
2020-07-15 02:16:22.825298 (Thread-1): finished collecting timing info
2020-07-15 02:16:22.828289 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b7705b5-675a-47ec-b265-ec525e82fc17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067382C8>]}
2020-07-15 02:16:22.832278 (Thread-1): 23:16:22 | 3 of 3 OK created table model dbt_lucas.my_second_dbt_model.......... [CREATE TABLE (1) in 2.64s]
2020-07-15 02:16:22.835345 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-07-15 02:16:22.838264 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:16:22.839218 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:16:22.840257 (MainThread): 23:16:22 | 
2020-07-15 02:16:22.841219 (MainThread): 23:16:22 | Finished running 2 table models, 1 view model in 9.03s.
2020-07-15 02:16:22.842241 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:16:22.842241 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:16:22.842241 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:16:22.843266 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was left open.
2020-07-15 02:16:22.886090 (MainThread): 
2020-07-15 02:16:22.886439 (MainThread): Completed successfully
2020-07-15 02:16:22.888143 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 02:16:22.890637 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067150E8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066E8820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066E8A30>]}
2020-07-15 02:16:22.891076 (MainThread): Flushing usage events
2020-07-15 02:16:57.600702 (MainThread): Running with dbt=0.17.0
2020-07-15 02:16:58.619471 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:16:58.622486 (MainThread): Tracking: tracking
2020-07-15 02:16:58.623488 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06513DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0718D598>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0718D5C8>]}
2020-07-15 02:16:58.671295 (MainThread): Partial parsing not enabled
2020-07-15 02:16:58.685262 (MainThread): Parsing macros\core.sql
2020-07-15 02:16:58.692285 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:16:58.744103 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:16:58.754129 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:16:58.756073 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:16:58.759060 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:16:58.762067 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:16:58.764050 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:16:58.766109 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:16:58.776160 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:16:58.794965 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:16:58.797955 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:16:58.808180 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:16:58.832120 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:16:58.864034 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:16:58.868025 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:16:58.886978 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:16:58.896948 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:16:58.903927 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:16:58.911910 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:16:58.916899 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:16:58.920883 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:16:58.924873 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:16:58.930856 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:16:58.957785 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:16:58.966801 (MainThread): Parsing macros\etc.sql
2020-07-15 02:16:58.969752 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:16:59.011728 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:16:59.019619 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:16:59.025747 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:16:59.057566 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:16:59.124911 (MainThread): Partial parsing not enabled
2020-07-15 02:16:59.223643 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:16:59.224106 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:16:59.462686 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:16:59.463682 (MainThread): 
2020-07-15 02:16:59.463682 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:16:59.463682 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:16:59.467672 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:16:59.467946 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:17:00.129440 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:17:00.131066 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:17:00.134422 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:17:00.816268 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:17:00.816268 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:17:00.817313 (MainThread): 23:17:00 | Concurrency: 1 threads (target='dev')
2020-07-15 02:17:00.818269 (MainThread): 23:17:00 | 
2020-07-15 02:17:00.831236 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:17:00.834228 (Thread-1): 23:17:00 | 1 of 1 START view model dbt_lucas.customers.......................... [RUN]
2020-07-15 02:17:00.834736 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:17:00.835224 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:17:00.835224 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:17:00.856166 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:17:00.861153 (Thread-1): finished collecting timing info
2020-07-15 02:17:00.896058 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:17:00.902042 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`customers`
  OPTIONS()
  as 

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-07-15 02:17:02.466873 (Thread-1): finished collecting timing info
2020-07-15 02:17:02.467874 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5d9ca8e-72ec-4c25-833b-f60a630714db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0724FC40>]}
2020-07-15 02:17:02.470818 (Thread-1): 23:17:02 | 1 of 1 OK created view model dbt_lucas.customers..................... [CREATE VIEW in 1.63s]
2020-07-15 02:17:02.472866 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:17:02.474807 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:17:02.474807 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:17:02.475852 (MainThread): 23:17:02 | 
2020-07-15 02:17:02.476805 (MainThread): 23:17:02 | Finished running 1 view model in 3.01s.
2020-07-15 02:17:02.477070 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:17:02.477862 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:17:02.478169 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:17:02.478169 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 02:17:02.499744 (MainThread): 
2020-07-15 02:17:02.501320 (MainThread): Completed successfully
2020-07-15 02:17:02.503813 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-07-15 02:17:02.506725 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x072E1A48>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0737A718>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0737A730>]}
2020-07-15 02:17:02.507069 (MainThread): Flushing usage events
2020-07-15 02:22:08.978421 (MainThread): Running with dbt=0.17.0
2020-07-15 02:22:09.854789 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:22:09.857745 (MainThread): Tracking: tracking
2020-07-15 02:22:09.858743 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06775D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x073ED628>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x073ED718>]}
2020-07-15 02:22:09.918583 (MainThread): Partial parsing not enabled
2020-07-15 02:22:09.937069 (MainThread): Parsing macros\core.sql
2020-07-15 02:22:09.949040 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:22:10.016853 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:22:10.032897 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:22:10.034900 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:22:10.039927 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:22:10.043967 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:22:10.047862 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:22:10.052086 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:22:10.077027 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:22:10.115992 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:22:10.119914 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:22:10.132923 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:22:10.162795 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:22:10.198880 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:22:10.201691 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:22:10.222683 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:22:10.232608 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:22:10.240639 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:22:10.249618 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:22:10.253553 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:22:10.255548 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:22:10.257632 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:22:10.261531 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:22:10.278491 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:22:10.287507 (MainThread): Parsing macros\etc.sql
2020-07-15 02:22:10.291719 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:22:10.325390 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:22:10.329349 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:22:10.333340 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:22:10.350294 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:22:10.398170 (MainThread): Partial parsing not enabled
2020-07-15 02:22:10.448374 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:22:10.448374 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:22:10.483281 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:22:10.483281 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:22:10.498278 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:22:10.498278 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:22:10.677761 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:22:10.677761 (MainThread): 
2020-07-15 02:22:10.678759 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:22:10.678759 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:22:10.683746 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:22:10.683746 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:22:11.714644 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:22:11.715644 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:22:11.718638 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:22:12.313556 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:22:12.314551 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:22:12.314912 (MainThread): 23:22:12 | Concurrency: 1 threads (target='dev')
2020-07-15 02:22:12.315550 (MainThread): 23:22:12 | 
2020-07-15 02:22:12.324522 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 02:22:12.325519 (Thread-1): 23:22:12 | 1 of 3 START table model dbt_lucas.stg_customers..................... [RUN]
2020-07-15 02:22:12.326516 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:22:12.326516 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:22:12.326516 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 02:22:12.347988 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:22:12.353973 (Thread-1): finished collecting timing info
2020-07-15 02:22:12.422787 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:22:12.427774 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2020-07-15 02:22:15.406645 (Thread-1): finished collecting timing info
2020-07-15 02:22:15.408642 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe401d9-dd6c-4795-b919-36551a694d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x074FF370>]}
2020-07-15 02:22:15.410652 (Thread-1): 23:22:15 | 1 of 3 OK created table model dbt_lucas.stg_customers................ [CREATE TABLE (100) in 3.08s]
2020-07-15 02:22:15.412583 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 02:22:15.412583 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 02:22:15.415626 (Thread-1): 23:22:15 | 2 of 3 START table model dbt_lucas.stg_orders........................ [RUN]
2020-07-15 02:22:15.416332 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:22:15.416618 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers).
2020-07-15 02:22:15.416618 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 02:22:15.428542 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:22:15.437584 (Thread-1): finished collecting timing info
2020-07-15 02:22:15.455790 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:22:15.465089 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2020-07-15 02:22:18.047578 (Thread-1): finished collecting timing info
2020-07-15 02:22:18.048572 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe401d9-dd6c-4795-b919-36551a694d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075D4388>]}
2020-07-15 02:22:18.051494 (Thread-1): 23:22:18 | 2 of 3 OK created table model dbt_lucas.stg_orders................... [CREATE TABLE (99) in 2.63s]
2020-07-15 02:22:18.053491 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 02:22:18.054487 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:22:18.057477 (Thread-1): 23:22:18 | 3 of 3 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 02:22:18.058475 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:22:18.058475 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders).
2020-07-15 02:22:18.059475 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:22:18.075429 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:22:18.080416 (Thread-1): finished collecting timing info
2020-07-15 02:22:18.086400 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:22:18.451821 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:22:18.661857 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:22:18.668319 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`

),

orders as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 02:22:21.294320 (Thread-1): finished collecting timing info
2020-07-15 02:22:21.297312 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abe401d9-dd6c-4795-b919-36551a694d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07AE9208>]}
2020-07-15 02:22:21.299755 (Thread-1): 23:22:21 | 3 of 3 OK created table model dbt_lucas.customers.................... [CREATE TABLE (100) in 3.24s]
2020-07-15 02:22:21.300380 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:22:21.302303 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:22:21.302303 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:22:21.303333 (MainThread): 23:22:21 | 
2020-07-15 02:22:21.303333 (MainThread): 23:22:21 | Finished running 3 table models in 10.62s.
2020-07-15 02:22:21.304294 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:22:21.304294 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:22:21.304294 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:22:21.304294 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 02:22:21.334213 (MainThread): 
2020-07-15 02:22:21.335210 (MainThread): Completed successfully
2020-07-15 02:22:21.335210 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 02:22:21.336207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07AC9F58>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07AE9178>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07AE9280>]}
2020-07-15 02:22:21.336207 (MainThread): Flushing usage events
2020-07-15 02:32:22.019329 (MainThread): Running with dbt=0.17.0
2020-07-15 02:32:22.498884 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:32:22.500842 (MainThread): Tracking: tracking
2020-07-15 02:32:22.500842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F45E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06BBA610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06BBA748>]}
2020-07-15 02:32:22.524392 (MainThread): Partial parsing not enabled
2020-07-15 02:32:22.531009 (MainThread): Parsing macros\core.sql
2020-07-15 02:32:22.535491 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:32:22.588353 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:32:22.597360 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:32:22.599323 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:32:22.601316 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:32:22.604321 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:32:22.606304 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:32:22.608312 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:32:22.616293 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:32:22.631238 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:32:22.634234 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:32:22.641211 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:32:22.665146 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:32:22.695104 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:32:22.698100 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:32:22.716047 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:32:22.723989 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:32:22.729008 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:32:22.736970 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:32:22.738985 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:32:22.740944 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:32:22.741978 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:32:22.744973 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:32:22.763883 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:32:22.770904 (MainThread): Parsing macros\etc.sql
2020-07-15 02:32:22.771876 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:32:22.785824 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:32:22.787855 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:32:22.790811 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:32:22.801781 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:32:22.826714 (MainThread): Partial parsing not enabled
2020-07-15 02:32:22.860675 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:32:22.860675 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:32:22.887603 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:32:22.887603 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:32:22.896573 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:32:22.896573 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:32:23.058306 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:32:23.059303 (MainThread): 
2020-07-15 02:32:23.059303 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:32:23.060303 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:32:23.065287 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:32:23.066285 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:32:23.760012 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:32:23.760012 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:32:23.762005 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:32:24.215695 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:32:24.215695 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:32:24.215695 (MainThread): 23:32:24 | Concurrency: 1 threads (target='dev')
2020-07-15 02:32:24.215695 (MainThread): 23:32:24 | 
2020-07-15 02:32:24.224684 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 02:32:24.225670 (Thread-1): 23:32:24 | 1 of 3 START table model dbt_lucas.stg_customers..................... [RUN]
2020-07-15 02:32:24.226668 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:32:24.226668 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:32:24.226668 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 02:32:24.243621 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:32:24.246614 (Thread-1): finished collecting timing info
2020-07-15 02:32:24.271547 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:32:24.793273 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:32:24.797219 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2020-07-15 02:32:27.282332 (Thread-1): finished collecting timing info
2020-07-15 02:32:27.283376 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577f351b-da37-4d8c-8154-26815fe5c323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06D48880>]}
2020-07-15 02:32:27.285370 (Thread-1): 23:32:27 | 1 of 3 OK created table model dbt_lucas.stg_customers................ [CREATE TABLE (100) in 3.06s]
2020-07-15 02:32:27.286320 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 02:32:27.286320 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 02:32:27.288354 (Thread-1): 23:32:27 | 2 of 3 START table model dbt_lucas.stg_orders........................ [RUN]
2020-07-15 02:32:27.288354 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:32:27.288354 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers).
2020-07-15 02:32:27.289348 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 02:32:27.295331 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:32:27.300281 (Thread-1): finished collecting timing info
2020-07-15 02:32:27.304272 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:32:27.504778 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:32:27.513723 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2020-07-15 02:32:29.858035 (Thread-1): finished collecting timing info
2020-07-15 02:32:29.859033 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577f351b-da37-4d8c-8154-26815fe5c323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06D43B80>]}
2020-07-15 02:32:29.860030 (Thread-1): 23:32:29 | 2 of 3 OK created table model dbt_lucas.stg_orders................... [CREATE TABLE (99) in 2.57s]
2020-07-15 02:32:29.861028 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 02:32:29.862039 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:32:29.863025 (Thread-1): 23:32:29 | 3 of 3 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 02:32:29.863025 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:32:29.863025 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders).
2020-07-15 02:32:29.863025 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:32:29.873011 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:32:29.875988 (Thread-1): finished collecting timing info
2020-07-15 02:32:29.879977 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:32:30.046946 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:32:30.050936 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`

),

orders as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

customer_orders as (

    selec
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 02:32:30.271616 (Thread-1): finished collecting timing info
2020-07-15 02:32:30.271616 (Thread-1): Database Error in model customers (models\customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
Traceback (most recent call last):
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 84, in exception_handler
    yield
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 359, in _retry_and_handle
    return retry.retry_target(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\api_core\future\polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]

(job ID: 292f6d93-f329-4e89-a12c-1b160fe7365c)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with customers as (
  10:
  11:    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  12:
  13:),
  14:
  15:orders as (
  16:
  17:    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  18:
  19:),
  20:
  21:customer_orders as (
  22:
  23:    selec
  24:        customer_id,
  25:
  26:        min(order_date) as first_order_date,
  27:        max(order_date) as most_recent_order_date,
  28:        count(order_id) as number_of_orders
  29:
  30:    from orders
  31:
  32:    group by 1
  33:
  34:),
  35:
  36:
  37:final as (
  38:
  39:    select
  40:        customers.customer_id,
  41:        customers.first_name,
  42:        customers.last_name,
  43:        customer_orders.first_order_date,
  44:        customer_orders.most_recent_order_date,
  45:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  46:
  47:    from customers
  48:
  49:    left join customer_orders using (customer_id)
  50:
  51:)
  52:
  53:select * from final
  54:  );
  55:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 225, in execute
    return self.connections.execute(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 359, in _retry_and_handle
    return retry.retry_target(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models\customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-07-15 02:32:30.328464 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '577f351b-da37-4d8c-8154-26815fe5c323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x079DE820>]}
2020-07-15 02:32:30.330460 (Thread-1): 23:32:30 | 3 of 3 ERROR creating table model dbt_lucas.customers................ [ERROR in 0.47s]
2020-07-15 02:32:30.330460 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:32:30.331457 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:32:30.332453 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:32:30.332453 (MainThread): 23:32:30 | 
2020-07-15 02:32:30.332453 (MainThread): 23:32:30 | Finished running 3 table models in 7.27s.
2020-07-15 02:32:30.332453 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:32:30.333452 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:32:30.333452 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:32:30.333452 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 02:32:30.350405 (MainThread): 
2020-07-15 02:32:30.351403 (MainThread): Completed with 1 error and 0 warnings:
2020-07-15 02:32:30.351403 (MainThread): 
2020-07-15 02:32:30.352401 (MainThread): Database Error in model customers (models\customers.sql)
2020-07-15 02:32:30.352401 (MainThread):   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
2020-07-15 02:32:30.352401 (MainThread):   compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-07-15 02:32:30.353398 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2020-07-15 02:32:30.353398 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x079877C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06CCF718>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x072997A8>]}
2020-07-15 02:32:30.353398 (MainThread): Flushing usage events
2020-07-15 02:35:21.138372 (MainThread): Running with dbt=0.17.0
2020-07-15 02:35:21.805391 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:35:21.807617 (MainThread): Tracking: tracking
2020-07-15 02:35:21.807617 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x061A5E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06E1A580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06E1A6A0>]}
2020-07-15 02:35:21.831554 (MainThread): Partial parsing not enabled
2020-07-15 02:35:21.840529 (MainThread): Parsing macros\core.sql
2020-07-15 02:35:21.848559 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:35:21.902671 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:35:21.914641 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:35:21.918629 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:35:21.923617 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:35:21.927606 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:35:21.931348 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:35:21.935379 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:35:21.946312 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:35:21.964263 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:35:21.968252 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:35:21.978225 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:35:22.005153 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:35:22.037068 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:35:22.043052 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:35:22.062925 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:35:22.072905 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:35:22.081156 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:35:22.089921 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:35:22.093883 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:35:22.096864 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:35:22.099892 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:35:22.105853 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:35:22.126806 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:35:22.135775 (MainThread): Parsing macros\etc.sql
2020-07-15 02:35:22.139792 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:35:22.155722 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:35:22.159711 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:35:22.164698 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:35:22.177259 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:35:22.203192 (MainThread): Partial parsing not enabled
2020-07-15 02:35:22.239840 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:35:22.239840 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:35:22.268197 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:35:22.268197 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:22.278174 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:35:22.278174 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:22.432718 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:35:22.433716 (MainThread): 
2020-07-15 02:35:22.433716 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:22.433716 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:22.437705 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:35:22.438728 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:35:23.169960 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:35:23.170957 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:35:23.171956 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:35:23.573993 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:23.573993 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:23.574991 (MainThread): 23:35:23 | Concurrency: 1 threads (target='dev')
2020-07-15 02:35:23.574991 (MainThread): 23:35:23 | 
2020-07-15 02:35:23.589950 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:35:23.590948 (Thread-1): 23:35:23 | 1 of 1 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 02:35:23.591944 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:35:23.591944 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:35:23.591944 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:35:23.608899 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:35:23.612888 (Thread-1): finished collecting timing info
2020-07-15 02:35:23.641812 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:35:24.137236 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:35:24.141226 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`

),

orders as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

customer_orders as (

    selec
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 02:35:24.339783 (Thread-1): finished collecting timing info
2020-07-15 02:35:24.340781 (Thread-1): Database Error in model customers (models\customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
Traceback (most recent call last):
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 84, in exception_handler
    yield
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 359, in _retry_and_handle
    return retry.retry_target(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\api_core\future\polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]

(job ID: 3e318d33-7bbd-40f7-b657-a8a5cc9fcc98)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with customers as (
  10:
  11:    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  12:
  13:),
  14:
  15:orders as (
  16:
  17:    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  18:
  19:),
  20:
  21:customer_orders as (
  22:
  23:    selec
  24:        customer_id,
  25:
  26:        min(order_date) as first_order_date,
  27:        max(order_date) as most_recent_order_date,
  28:        count(order_id) as number_of_orders
  29:
  30:    from orders
  31:
  32:    group by 1
  33:
  34:),
  35:
  36:
  37:final as (
  38:
  39:    select
  40:        customers.customer_id,
  41:        customers.first_name,
  42:        customers.last_name,
  43:        customer_orders.first_order_date,
  44:        customer_orders.most_recent_order_date,
  45:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  46:
  47:    from customers
  48:
  49:    left join customer_orders using (customer_id)
  50:
  51:)
  52:
  53:select * from final
  54:  );
  55:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 225, in execute
    return self.connections.execute(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 359, in _retry_and_handle
    return retry.retry_target(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models\customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-07-15 02:35:24.389645 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '691d665e-77dc-4ee6-aa29-405d11c2d273', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x074E0190>]}
2020-07-15 02:35:24.390642 (Thread-1): 23:35:24 | 1 of 1 ERROR creating table model dbt_lucas.customers................ [ERROR in 0.80s]
2020-07-15 02:35:24.391620 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:35:24.392622 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:24.392622 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:24.392622 (MainThread): 23:35:24 | 
2020-07-15 02:35:24.393616 (MainThread): 23:35:24 | Finished running 1 table model in 1.96s.
2020-07-15 02:35:24.393616 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:35:24.393616 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:35:24.393616 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:35:24.393616 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 02:35:24.401607 (MainThread): 
2020-07-15 02:35:24.402605 (MainThread): Completed with 1 error and 0 warnings:
2020-07-15 02:35:24.402605 (MainThread): 
2020-07-15 02:35:24.402605 (MainThread): Database Error in model customers (models\customers.sql)
2020-07-15 02:35:24.403605 (MainThread):   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
2020-07-15 02:35:24.403605 (MainThread):   compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-07-15 02:35:24.403605 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-07-15 02:35:24.404602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06FCE460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06FAF778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06F424C0>]}
2020-07-15 02:35:24.404602 (MainThread): Flushing usage events
2020-07-15 02:35:37.497868 (MainThread): Running with dbt=0.17.0
2020-07-15 02:35:37.983095 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:35:37.985122 (MainThread): Tracking: tracking
2020-07-15 02:35:37.985122 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06785D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x073FD670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x073FD760>]}
2020-07-15 02:35:38.008128 (MainThread): Partial parsing not enabled
2020-07-15 02:35:38.015110 (MainThread): Parsing macros\core.sql
2020-07-15 02:35:38.020098 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:35:38.073952 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:35:38.084924 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:35:38.085954 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:35:38.087948 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:35:38.090908 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:35:38.092934 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:35:38.094896 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:35:38.103873 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:35:38.119870 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:35:38.122823 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:35:38.132796 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:35:38.155734 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:35:38.187650 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:35:38.190641 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:35:38.208592 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:35:38.217568 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:35:38.224549 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:35:38.231564 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:35:38.234523 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:35:38.236519 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:35:38.237784 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:35:38.240778 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:35:38.258768 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:35:38.266709 (MainThread): Parsing macros\etc.sql
2020-07-15 02:35:38.267739 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:35:38.282701 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:35:38.287686 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:35:38.289683 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:35:38.300652 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:35:38.326550 (MainThread): Partial parsing not enabled
2020-07-15 02:35:38.362454 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:35:38.362454 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:35:38.392407 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:35:38.392407 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:38.402347 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:35:38.402347 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:38.567137 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:35:38.567137 (MainThread): 
2020-07-15 02:35:38.568135 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:38.568135 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:38.571127 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:35:38.571127 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:35:39.067538 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:35:39.067538 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:35:39.068538 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:35:39.432043 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:39.432043 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:39.433010 (MainThread): 23:35:39 | Concurrency: 1 threads (target='dev')
2020-07-15 02:35:39.433010 (MainThread): 23:35:39 | 
2020-07-15 02:35:39.440989 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:35:39.442032 (Thread-1): 23:35:39 | 1 of 1 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 02:35:39.442984 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:35:39.442984 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:35:39.442984 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:35:39.460934 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:35:39.464923 (Thread-1): finished collecting timing info
2020-07-15 02:35:39.489857 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:35:39.989087 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:35:39.994075 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`

),

orders as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

customer_orders as (

    selec
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 02:35:40.176760 (Thread-1): finished collecting timing info
2020-07-15 02:35:40.176760 (Thread-1): Database Error in model customers (models\customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
Traceback (most recent call last):
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 84, in exception_handler
    yield
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 359, in _retry_and_handle
    return retry.retry_target(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\api_core\retry.py", line 184, in retry_target
    return target()
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 225, in fn
    return self._query_and_results(client, sql, conn, job_params)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 352, in _query_and_results
    iterator = query_job.result(timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\cloud\bigquery\job.py", line 3196, in result
    super(QueryJob, self).result(retry=retry, timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\cloud\bigquery\job.py", line 818, in result
    return super(_AsyncJob, self).result(timeout=timeout)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\google\api_core\future\polling.py", line 127, in result
    raise self._exception
google.api_core.exceptions.BadRequest: 400 Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]

(job ID: f8ef677b-2c2d-476a-b2cb-673d84d2887f)

                                                         -----Query Job SQL Follows-----                                                         

    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |
   1:/* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */
   2:
   3:
   4:  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
   5:  
   6:  
   7:  OPTIONS()
   8:  as (
   9:    with customers as (
  10:
  11:    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  12:
  13:),
  14:
  15:orders as (
  16:
  17:    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  18:
  19:),
  20:
  21:customer_orders as (
  22:
  23:    selec
  24:        customer_id,
  25:
  26:        min(order_date) as first_order_date,
  27:        max(order_date) as most_recent_order_date,
  28:        count(order_id) as number_of_orders
  29:
  30:    from orders
  31:
  32:    group by 1
  33:
  34:),
  35:
  36:
  37:final as (
  38:
  39:    select
  40:        customers.customer_id,
  41:        customers.first_name,
  42:        customers.last_name,
  43:        customer_orders.first_order_date,
  44:        customer_orders.most_recent_order_date,
  45:        coalesce(customer_orders.number_of_orders, 0) as number_of_orders
  46:
  47:    from customers
  48:
  49:    left join customer_orders using (customer_id)
  50:
  51:)
  52:
  53:select * from final
  54:  );
  55:    
    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |    .    |

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 128, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\base\impl.py", line 225, in execute
    return self.connections.execute(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 234, in execute
    query_job, iterator = self.raw_execute(sql, fetch=fetch)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 227, in raw_execute
    query_job, iterator = self._retry_and_handle(msg=sql, conn=conn, fn=fn)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 359, in _retry_and_handle
    return retry.retry_target(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 88, in exception_handler
    self.handle_error(e, message)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\adapters\bigquery\connections.py", line 76, in handle_error
    raise DatabaseException(error_msg)
dbt.exceptions.DatabaseException: Database Error in model customers (models\customers.sql)
  Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
  compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-07-15 02:35:40.183742 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a14b5cd9-9483-4e13-973c-1c3be8786dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0764FFE8>]}
2020-07-15 02:35:40.184773 (Thread-1): 23:35:40 | 1 of 1 ERROR creating table model dbt_lucas.customers................ [ERROR in 0.74s]
2020-07-15 02:35:40.185743 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:35:40.186734 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:40.186734 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:40.186734 (MainThread): 23:35:40 | 
2020-07-15 02:35:40.186734 (MainThread): 23:35:40 | Finished running 1 table model in 1.62s.
2020-07-15 02:35:40.187732 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:35:40.187732 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:35:40.187732 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:35:40.187732 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 02:35:40.196707 (MainThread): 
2020-07-15 02:35:40.197170 (MainThread): Completed with 1 error and 0 warnings:
2020-07-15 02:35:40.197766 (MainThread): 
2020-07-15 02:35:40.197766 (MainThread): Database Error in model customers (models\customers.sql)
2020-07-15 02:35:40.198232 (MainThread):   Syntax error: Expected "(" or keyword SELECT or keyword WITH but got identifier "selec" at [23:5]
2020-07-15 02:35:40.198232 (MainThread):   compiled SQL at target\run\jaffle_shop\models\customers.sql
2020-07-15 02:35:40.198232 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2020-07-15 02:35:40.198232 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075CEF28>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075D9F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x075A91C0>]}
2020-07-15 02:35:40.199232 (MainThread): Flushing usage events
2020-07-15 02:35:46.476094 (MainThread): Running with dbt=0.17.0
2020-07-15 02:35:46.938577 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:35:46.939537 (MainThread): Tracking: tracking
2020-07-15 02:35:46.940535 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05FF5DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C6F640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C6F6E8>]}
2020-07-15 02:35:46.962476 (MainThread): Partial parsing not enabled
2020-07-15 02:35:46.970480 (MainThread): Parsing macros\core.sql
2020-07-15 02:35:46.975440 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:35:47.028299 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:35:47.038272 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:35:47.040305 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:35:47.042298 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:35:47.045254 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:35:47.047248 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:35:47.049243 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:35:47.057228 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:35:47.072182 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:35:47.075173 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:35:47.082155 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:35:47.108085 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:35:47.140001 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:35:47.142992 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:35:47.161942 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:35:47.169922 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:35:47.178897 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:35:47.188869 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:35:47.191863 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:35:47.193856 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:35:47.195851 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:35:47.198843 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:35:47.217794 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:35:47.224773 (MainThread): Parsing macros\etc.sql
2020-07-15 02:35:47.226770 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:35:47.240759 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:35:47.243724 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:35:47.246716 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:35:47.260713 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:35:47.289601 (MainThread): Partial parsing not enabled
2020-07-15 02:35:47.329495 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:35:47.329495 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:35:47.362407 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:35:47.362407 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:47.374373 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:35:47.374373 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:47.573840 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:35:47.573840 (MainThread): 
2020-07-15 02:35:47.574837 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:47.574837 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:47.577829 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:35:47.577829 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:35:48.109558 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:35:48.109558 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:35:48.110531 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:35:48.566824 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:48.566824 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:48.567876 (MainThread): 23:35:48 | Concurrency: 1 threads (target='dev')
2020-07-15 02:35:48.567876 (MainThread): 23:35:48 | 
2020-07-15 02:35:48.577796 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:35:48.579833 (Thread-1): 23:35:48 | 1 of 1 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 02:35:48.580787 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:35:48.580787 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:35:48.580787 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:35:48.600768 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:35:48.607738 (Thread-1): finished collecting timing info
2020-07-15 02:35:48.629667 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:35:49.129329 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:35:49.134304 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`

),

orders as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 02:35:51.833330 (Thread-1): finished collecting timing info
2020-07-15 02:35:51.835328 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6700c998-9e17-4abb-9ed4-c1d39e7fd184', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06E68CA0>]}
2020-07-15 02:35:51.836326 (Thread-1): 23:35:51 | 1 of 1 OK created table model dbt_lucas.customers.................... [CREATE TABLE (100) in 3.25s]
2020-07-15 02:35:51.838269 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:35:51.839264 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:35:51.839264 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:35:51.840264 (MainThread): 23:35:51 | 
2020-07-15 02:35:51.840264 (MainThread): 23:35:51 | Finished running 1 table model in 4.27s.
2020-07-15 02:35:51.841260 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:35:51.841260 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:35:51.841260 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:35:51.841260 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 02:35:51.853227 (MainThread): 
2020-07-15 02:35:51.853227 (MainThread): Completed successfully
2020-07-15 02:35:51.854224 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-07-15 02:35:51.854224 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06E1E1D8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06EBEA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06EBE430>]}
2020-07-15 02:35:51.854224 (MainThread): Flushing usage events
2020-07-15 02:37:19.368940 (MainThread): Running with dbt=0.17.0
2020-07-15 02:37:19.825443 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:37:19.826477 (MainThread): Tracking: tracking
2020-07-15 02:37:19.827456 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065C5DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07239670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x072396E8>]}
2020-07-15 02:37:19.848383 (MainThread): Partial parsing not enabled
2020-07-15 02:37:19.855364 (MainThread): Parsing macros\core.sql
2020-07-15 02:37:19.860352 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:37:19.912212 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:37:19.921223 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:37:19.923195 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:37:19.925176 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:37:19.927208 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:37:19.929165 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:37:19.931161 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:37:19.939139 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:37:19.954100 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:37:19.956131 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:37:19.963076 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:37:19.986015 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:37:20.014936 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:37:20.016964 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:37:20.033886 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:37:20.041207 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:37:20.047218 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:37:20.054202 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:37:20.056240 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:37:20.058192 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:37:20.059224 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:37:20.062181 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:37:20.080133 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:37:20.086116 (MainThread): Parsing macros\etc.sql
2020-07-15 02:37:20.087155 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:37:20.100122 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:37:20.103071 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:37:20.105103 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:37:20.116037 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:37:20.139972 (MainThread): Partial parsing not enabled
2020-07-15 02:37:20.175913 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:37:20.175913 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:37:20.202840 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:37:20.202840 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:37:20.211819 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:37:20.211819 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:37:20.364573 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:37:20.365568 (MainThread): 
2020-07-15 02:37:20.365568 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:37:20.365568 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:37:20.370555 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:37:20.370555 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:37:20.904842 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:37:20.905840 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:37:20.908885 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:37:21.391588 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:37:21.391588 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:37:21.392604 (MainThread): 23:37:21 | Concurrency: 1 threads (target='dev')
2020-07-15 02:37:21.392604 (MainThread): 23:37:21 | 
2020-07-15 02:37:21.403520 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 02:37:21.404556 (Thread-1): 23:37:21 | 1 of 3 START table model dbt_lucas.stg_customers..................... [RUN]
2020-07-15 02:37:21.405555 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:37:21.405555 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:37:21.405555 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 02:37:21.424462 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:37:21.429450 (Thread-1): finished collecting timing info
2020-07-15 02:37:21.452388 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:37:21.937401 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:37:21.940422 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  
  
  OPTIONS()
  as (
    select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers
  );
    
2020-07-15 02:37:24.038919 (Thread-1): finished collecting timing info
2020-07-15 02:37:24.038919 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df798015-71b2-4575-b8c6-7096d250c6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0791A3A0>]}
2020-07-15 02:37:24.039918 (Thread-1): 23:37:24 | 1 of 3 OK created table model dbt_lucas.stg_customers................ [CREATE TABLE (100) in 2.63s]
2020-07-15 02:37:24.040870 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 02:37:24.040870 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 02:37:24.041868 (Thread-1): 23:37:24 | 2 of 3 START table model dbt_lucas.stg_orders........................ [RUN]
2020-07-15 02:37:24.042864 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:37:24.042864 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers).
2020-07-15 02:37:24.042864 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 02:37:24.047853 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:37:24.051839 (Thread-1): finished collecting timing info
2020-07-15 02:37:24.055868 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:37:24.227396 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:37:24.241313 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  
  
  OPTIONS()
  as (
    select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders
  );
    
2020-07-15 02:37:26.941001 (Thread-1): finished collecting timing info
2020-07-15 02:37:26.942997 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df798015-71b2-4575-b8c6-7096d250c6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x073C27D8>]}
2020-07-15 02:37:26.946984 (Thread-1): 23:37:26 | 2 of 3 OK created table model dbt_lucas.stg_orders................... [CREATE TABLE (99) in 2.90s]
2020-07-15 02:37:26.948989 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 02:37:26.949927 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:37:26.952983 (Thread-1): 23:37:26 | 3 of 3 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 02:37:26.953914 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:37:26.953914 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders).
2020-07-15 02:37:26.953914 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:37:26.961889 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:37:26.966895 (Thread-1): finished collecting timing info
2020-07-15 02:37:26.969900 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:37:27.126024 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:37:27.130013 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`

),

orders as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 02:37:29.576837 (Thread-1): finished collecting timing info
2020-07-15 02:37:29.578828 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df798015-71b2-4575-b8c6-7096d250c6cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x08007D30>]}
2020-07-15 02:37:29.580777 (Thread-1): 23:37:29 | 3 of 3 OK created table model dbt_lucas.customers.................... [CREATE TABLE (100) in 2.62s]
2020-07-15 02:37:29.582774 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:37:29.584768 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:37:29.584768 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:37:29.585830 (MainThread): 23:37:29 | 
2020-07-15 02:37:29.585830 (MainThread): 23:37:29 | Finished running 3 table models in 9.22s.
2020-07-15 02:37:29.586761 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:37:29.586761 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:37:29.586761 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:37:29.587763 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 02:37:29.609700 (MainThread): 
2020-07-15 02:37:29.609700 (MainThread): Completed successfully
2020-07-15 02:37:29.610697 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 02:37:29.610697 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07437868>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x073F3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0791A868>]}
2020-07-15 02:37:29.611695 (MainThread): Flushing usage events
2020-07-15 02:38:13.013210 (MainThread): Running with dbt=0.17.0
2020-07-15 02:38:13.496642 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:38:13.500590 (MainThread): Tracking: tracking
2020-07-15 02:38:13.500590 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05935D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065A9898>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065A9820>]}
2020-07-15 02:38:13.523518 (MainThread): Partial parsing not enabled
2020-07-15 02:38:13.530675 (MainThread): Parsing macros\core.sql
2020-07-15 02:38:13.535710 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:38:13.585558 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:38:13.594503 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:38:13.596499 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:38:13.598494 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:38:13.601485 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:38:13.603479 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:38:13.604477 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:38:13.612488 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:38:13.628413 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:38:13.632431 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:38:13.639384 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:38:13.660329 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:38:13.689282 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:38:13.692243 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:38:13.711193 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:38:13.719171 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:38:13.724158 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:38:13.731138 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:38:13.733388 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:38:13.734425 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:38:13.736394 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:38:13.739374 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:38:13.758323 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:38:13.765306 (MainThread): Parsing macros\etc.sql
2020-07-15 02:38:13.766519 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:38:13.780485 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:38:13.782520 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:38:13.785472 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:38:13.795445 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:38:13.819381 (MainThread): Partial parsing not enabled
2020-07-15 02:38:13.854328 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:38:13.854328 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:38:13.885243 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:38:13.885243 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:38:13.895178 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:38:13.896176 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:38:14.055526 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:38:14.056525 (MainThread): 
2020-07-15 02:38:14.056525 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:38:14.056525 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:38:14.062509 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:38:14.062509 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:38:14.629282 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:38:14.629282 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:38:14.632223 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:38:15.142197 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:38:15.142197 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:38:15.142197 (MainThread): 23:38:15 | Concurrency: 1 threads (target='dev')
2020-07-15 02:38:15.142926 (MainThread): 23:38:15 | 
2020-07-15 02:38:15.148669 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 02:38:15.149668 (Thread-1): 23:38:15 | 1 of 3 START view model dbt_lucas.stg_customers...................... [RUN]
2020-07-15 02:38:15.150665 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:38:15.150665 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:38:15.150665 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 02:38:15.168618 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:38:15.171609 (Thread-1): finished collecting timing info
2020-07-15 02:38:15.196542 (Thread-1): finished collecting timing info
2020-07-15 02:38:15.196542 (Thread-1): Compilation Error in model stg_customers (models\staging\stg_customers.sql)
  Trying to create view `bigquery-dbt`.`dbt_lucas`.`stg_customers`, but it currently exists as a table. Either drop `bigquery-dbt`.`dbt_lucas`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model stg_customers (models\staging\stg_customers.sql)
Traceback (most recent call last):
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\exceptions.py", line 966, in inner
    raise exc
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\exceptions.py", line 963, in inner
    return func(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\exceptions.py", line 626, in relation_wrong_type
    raise_compiler_error(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_customers (models\staging\stg_customers.sql)
  Trying to create view `bigquery-dbt`.`dbt_lucas`.`stg_customers`, but it currently exists as a table. Either drop `bigquery-dbt`.`dbt_lucas`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model stg_customers (models\staging\stg_customers.sql)
2020-07-15 02:38:15.204394 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44680637-8a42-46fb-b0cb-891522444402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067A86A0>]}
2020-07-15 02:38:15.206395 (Thread-1): 23:38:15 | 1 of 3 ERROR creating view model dbt_lucas.stg_customers............. [ERROR in 0.05s]
2020-07-15 02:38:15.207393 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 02:38:15.207393 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 02:38:15.209380 (Thread-1): 23:38:15 | 2 of 3 START view model dbt_lucas.stg_orders......................... [RUN]
2020-07-15 02:38:15.210377 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:38:15.210377 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 02:38:15.211376 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 02:38:15.216360 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:38:15.219353 (Thread-1): finished collecting timing info
2020-07-15 02:38:15.224341 (Thread-1): finished collecting timing info
2020-07-15 02:38:15.224341 (Thread-1): Compilation Error in model stg_orders (models\staging\stg_orders.sql)
  Trying to create view `bigquery-dbt`.`dbt_lucas`.`stg_orders`, but it currently exists as a table. Either drop `bigquery-dbt`.`dbt_lucas`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model stg_orders (models\staging\stg_orders.sql)
Traceback (most recent call last):
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 228, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 171, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 273, in run
    return self.execute(compiled_node, manifest)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\node_runners.py", line 459, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 21, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 96, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 296, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\clients\jinja.py", line 226, in call_macro
    return macro(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\exceptions.py", line 966, in inner
    raise exc
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\exceptions.py", line 963, in inner
    return func(*args, **kwargs)
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\exceptions.py", line 626, in relation_wrong_type
    raise_compiler_error(
  File "c:\users\lmrosario\appdata\local\programs\python\python38-32\lib\site-packages\dbt\exceptions.py", line 392, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model stg_orders (models\staging\stg_orders.sql)
  Trying to create view `bigquery-dbt`.`dbt_lucas`.`stg_orders`, but it currently exists as a table. Either drop `bigquery-dbt`.`dbt_lucas`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro adapter_macro (macros\adapters\common.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model stg_orders (models\staging\stg_orders.sql)
2020-07-15 02:38:15.226337 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44680637-8a42-46fb-b0cb-891522444402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C90550>]}
2020-07-15 02:38:15.228332 (Thread-1): 23:38:15 | 2 of 3 ERROR creating view model dbt_lucas.stg_orders................ [ERROR in 0.02s]
2020-07-15 02:38:15.229327 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 02:38:15.229327 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:38:15.229327 (Thread-1): 23:38:15 | 3 of 3 SKIP relation dbt_lucas.customers............................. [SKIP]
2020-07-15 02:38:15.230324 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:38:15.231321 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:38:15.231321 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:38:15.231321 (MainThread): 23:38:15 | 
2020-07-15 02:38:15.231321 (MainThread): 23:38:15 | Finished running 2 view models, 1 table model in 1.17s.
2020-07-15 02:38:15.232319 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:38:15.232319 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:38:15.232319 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:38:15.232319 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-07-15 02:38:15.246282 (MainThread): 
2020-07-15 02:38:15.246282 (MainThread): Completed with 2 errors and 0 warnings:
2020-07-15 02:38:15.246282 (MainThread): 
2020-07-15 02:38:15.247279 (MainThread): Compilation Error in model stg_customers (models\staging\stg_customers.sql)
2020-07-15 02:38:15.247279 (MainThread):   Trying to create view `bigquery-dbt`.`dbt_lucas`.`stg_customers`, but it currently exists as a table. Either drop `bigquery-dbt`.`dbt_lucas`.`stg_customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-07-15 02:38:15.247279 (MainThread):   
2020-07-15 02:38:15.247279 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2020-07-15 02:38:15.248275 (MainThread):   > called by macro adapter_macro (macros\adapters\common.sql)
2020-07-15 02:38:15.249273 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2020-07-15 02:38:15.249273 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2020-07-15 02:38:15.249273 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2020-07-15 02:38:15.249273 (MainThread):   > called by model stg_customers (models\staging\stg_customers.sql)
2020-07-15 02:38:15.249273 (MainThread): 
2020-07-15 02:38:15.250271 (MainThread): Compilation Error in model stg_orders (models\staging\stg_orders.sql)
2020-07-15 02:38:15.250271 (MainThread):   Trying to create view `bigquery-dbt`.`dbt_lucas`.`stg_orders`, but it currently exists as a table. Either drop `bigquery-dbt`.`dbt_lucas`.`stg_orders` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-07-15 02:38:15.250271 (MainThread):   
2020-07-15 02:38:15.250271 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2020-07-15 02:38:15.250271 (MainThread):   > called by macro adapter_macro (macros\adapters\common.sql)
2020-07-15 02:38:15.250271 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2020-07-15 02:38:15.251269 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2020-07-15 02:38:15.251269 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2020-07-15 02:38:15.252265 (MainThread):   > called by model stg_orders (models\staging\stg_orders.sql)
2020-07-15 02:38:15.252265 (MainThread): 
Done. PASS=0 WARN=0 ERROR=2 SKIP=1 TOTAL=3
2020-07-15 02:38:15.252265 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067ACA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06956028>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C90358>]}
2020-07-15 02:38:15.252265 (MainThread): Flushing usage events
2020-07-15 02:39:15.577368 (MainThread): Running with dbt=0.17.0
2020-07-15 02:39:16.053501 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:39:16.055451 (MainThread): Tracking: tracking
2020-07-15 02:39:16.055451 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05FD5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C4E778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C4E808>]}
2020-07-15 02:39:16.079388 (MainThread): Partial parsing not enabled
2020-07-15 02:39:16.087948 (MainThread): Parsing macros\core.sql
2020-07-15 02:39:16.092964 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:39:16.146794 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:39:16.156767 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:39:16.158761 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:39:16.160756 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:39:16.162750 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:39:16.164798 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:39:16.166741 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:39:16.174719 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:39:16.188770 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:39:16.191313 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:39:16.197937 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:39:16.219881 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:39:16.248820 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:39:16.252825 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:39:16.271742 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:39:16.280762 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:39:16.285736 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:39:16.293685 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:39:16.295715 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:39:16.297674 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:39:16.299667 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:39:16.302658 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:39:16.320651 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:39:16.326633 (MainThread): Parsing macros\etc.sql
2020-07-15 02:39:16.328589 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:39:16.343577 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:39:16.346552 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:39:16.349534 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:39:16.360505 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:39:16.384441 (MainThread): Partial parsing not enabled
2020-07-15 02:39:16.420384 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:39:16.420384 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:39:16.447311 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:39:16.447311 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:39:16.457283 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:39:16.457283 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:39:16.613144 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:39:16.614142 (MainThread): 
2020-07-15 02:39:16.614142 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:39:16.614142 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:39:16.619129 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:39:16.619129 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:39:17.176125 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:39:17.177352 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:39:17.179400 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:39:17.640085 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:39:17.640085 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:39:17.641137 (MainThread): 23:39:17 | Concurrency: 1 threads (target='dev')
2020-07-15 02:39:17.642079 (MainThread): 23:39:17 | 
2020-07-15 02:39:17.652425 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 02:39:17.653456 (Thread-1): 23:39:17 | 1 of 3 START view model dbt_lucas.stg_customers...................... [RUN]
2020-07-15 02:39:17.654422 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:39:17.654422 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:39:17.654422 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 02:39:17.668412 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:39:17.672375 (Thread-1): finished collecting timing info
2020-07-15 02:39:17.693318 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:39:18.184807 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:39:18.188796 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-07-15 02:39:19.306958 (Thread-1): finished collecting timing info
2020-07-15 02:39:19.307918 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c09c3d-dba1-46a8-8961-f2313c2d721c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06DDB778>]}
2020-07-15 02:39:19.308954 (Thread-1): 23:39:19 | 1 of 3 OK created view model dbt_lucas.stg_customers................. [CREATE VIEW in 1.65s]
2020-07-15 02:39:19.308954 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 02:39:19.309913 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 02:39:19.309913 (Thread-1): 23:39:19 | 2 of 3 START view model dbt_lucas.stg_orders......................... [RUN]
2020-07-15 02:39:19.310945 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:39:19.310945 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers).
2020-07-15 02:39:19.310945 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 02:39:19.315927 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:39:19.319885 (Thread-1): finished collecting timing info
2020-07-15 02:39:19.322912 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:39:19.582880 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:39:19.596787 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-07-15 02:39:20.556345 (Thread-1): finished collecting timing info
2020-07-15 02:39:20.557343 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c09c3d-dba1-46a8-8961-f2313c2d721c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06E4F460>]}
2020-07-15 02:39:20.559337 (Thread-1): 23:39:20 | 2 of 3 OK created view model dbt_lucas.stg_orders.................... [CREATE VIEW in 1.25s]
2020-07-15 02:39:20.561366 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 02:39:20.561652 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 02:39:20.562656 (Thread-1): 23:39:20 | 3 of 3 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 02:39:20.563681 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:39:20.563681 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders).
2020-07-15 02:39:20.563681 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 02:39:20.570660 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 02:39:20.574621 (Thread-1): finished collecting timing info
2020-07-15 02:39:20.590612 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:39:20.767953 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 02:39:20.774896 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`

),

orders as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 02:39:23.388743 (Thread-1): finished collecting timing info
2020-07-15 02:39:23.389740 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1c09c3d-dba1-46a8-8961-f2313c2d721c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06D76CB8>]}
2020-07-15 02:39:23.390738 (Thread-1): 23:39:23 | 3 of 3 OK created table model dbt_lucas.customers.................... [CREATE TABLE (100) in 2.83s]
2020-07-15 02:39:23.391736 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 02:39:23.392734 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:39:23.393730 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:39:23.393730 (MainThread): 23:39:23 | 
2020-07-15 02:39:23.393730 (MainThread): 23:39:23 | Finished running 2 view models, 1 table model in 6.78s.
2020-07-15 02:39:23.394727 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:39:23.394727 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:39:23.394727 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:39:23.394727 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 02:39:23.412679 (MainThread): 
2020-07-15 02:39:23.413676 (MainThread): Completed successfully
2020-07-15 02:39:23.414673 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 02:39:23.414673 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06FE86D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06FE8790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06E2C1A8>]}
2020-07-15 02:39:23.414673 (MainThread): Flushing usage events
2020-07-15 02:41:52.851367 (MainThread): Running with dbt=0.17.0
2020-07-15 02:41:53.323978 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['staging'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 02:41:53.325923 (MainThread): Tracking: tracking
2020-07-15 02:41:53.325923 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05925DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0659E820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0659E8B0>]}
2020-07-15 02:41:53.347865 (MainThread): Partial parsing not enabled
2020-07-15 02:41:53.357898 (MainThread): Parsing macros\core.sql
2020-07-15 02:41:53.362887 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 02:41:53.413796 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 02:41:53.422782 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 02:41:53.424753 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 02:41:53.426718 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 02:41:53.428712 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 02:41:53.431704 (MainThread): Parsing macros\etc\query.sql
2020-07-15 02:41:53.433698 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 02:41:53.441714 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 02:41:53.456638 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 02:41:53.459630 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 02:41:53.467645 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 02:41:53.490578 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 02:41:53.520466 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 02:41:53.523458 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 02:41:53.540413 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 02:41:53.547394 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 02:41:53.553414 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 02:41:53.561373 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 02:41:53.563386 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 02:41:53.565347 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 02:41:53.566375 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 02:41:53.569527 (MainThread): Parsing macros\adapters.sql
2020-07-15 02:41:53.585487 (MainThread): Parsing macros\catalog.sql
2020-07-15 02:41:53.592469 (MainThread): Parsing macros\etc.sql
2020-07-15 02:41:53.593466 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 02:41:53.609427 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 02:41:53.612414 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 02:41:53.614408 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 02:41:53.624412 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 02:41:53.650313 (MainThread): Partial parsing not enabled
2020-07-15 02:41:53.684271 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 02:41:53.684271 (MainThread): Opening a new connection, currently in state init
2020-07-15 02:41:53.711246 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:41:53.711246 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:41:53.722208 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:41:53.722208 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:41:53.876625 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 02:41:53.877627 (MainThread): 
2020-07-15 02:41:53.877627 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:41:53.877627 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:41:53.882612 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 02:41:53.882612 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 02:41:54.410894 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 02:41:54.410894 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 02:41:54.411893 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 02:41:54.935236 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:41:54.935236 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:41:54.935236 (MainThread): 23:41:54 | Concurrency: 1 threads (target='dev')
2020-07-15 02:41:54.935236 (MainThread): 23:41:54 | 
2020-07-15 02:41:54.942284 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 02:41:54.943283 (Thread-1): 23:41:54 | 1 of 2 START view model dbt_lucas.stg_customers...................... [RUN]
2020-07-15 02:41:54.943283 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 02:41:54.943283 (Thread-1): Opening a new connection, currently in state init
2020-07-15 02:41:54.943283 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 02:41:54.956285 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:41:54.960238 (Thread-1): finished collecting timing info
2020-07-15 02:41:54.995149 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 02:41:55.002125 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-07-15 02:41:56.379830 (Thread-1): finished collecting timing info
2020-07-15 02:41:56.380832 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90844684-98c2-4f49-9758-de25015aaeb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06731208>]}
2020-07-15 02:41:56.381824 (Thread-1): 23:41:56 | 1 of 2 OK created view model dbt_lucas.stg_customers................. [CREATE VIEW in 1.44s]
2020-07-15 02:41:56.381824 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 02:41:56.381824 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 02:41:56.382827 (Thread-1): 23:41:56 | 2 of 2 START view model dbt_lucas.stg_orders......................... [RUN]
2020-07-15 02:41:56.383789 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 02:41:56.383789 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers).
2020-07-15 02:41:56.383789 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 02:41:56.387840 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:41:56.391768 (Thread-1): finished collecting timing info
2020-07-15 02:41:56.395795 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 02:41:56.398748 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-07-15 02:41:57.376220 (Thread-1): finished collecting timing info
2020-07-15 02:41:57.377217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90844684-98c2-4f49-9758-de25015aaeb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0678D2C8>]}
2020-07-15 02:41:57.378215 (Thread-1): 23:41:57 | 2 of 2 OK created view model dbt_lucas.stg_orders.................... [CREATE VIEW in 0.99s]
2020-07-15 02:41:57.379212 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 02:41:57.380209 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 02:41:57.380209 (MainThread): Opening a new connection, currently in state closed
2020-07-15 02:41:57.380209 (MainThread): 23:41:57 | 
2020-07-15 02:41:57.381206 (MainThread): 23:41:57 | Finished running 2 view models in 3.50s.
2020-07-15 02:41:57.381206 (MainThread): Connection 'master' was properly closed.
2020-07-15 02:41:57.381206 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 02:41:57.381206 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 02:41:57.381206 (MainThread): Connection 'model.jaffle_shop.stg_orders' was left open.
2020-07-15 02:41:57.394171 (MainThread): 
2020-07-15 02:41:57.394171 (MainThread): Completed successfully
2020-07-15 02:41:57.395168 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-15 02:41:57.395168 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067701C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C70A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C70B80>]}
2020-07-15 02:41:57.395168 (MainThread): Flushing usage events
2020-07-15 03:14:28.765539 (MainThread): Running with dbt=0.17.0
2020-07-15 03:14:29.246947 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-15 03:14:29.248944 (MainThread): Tracking: tracking
2020-07-15 03:14:29.249941 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05DF4DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06A6D808>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06A6D850>]}
2020-07-15 03:14:29.272879 (MainThread): Partial parsing not enabled
2020-07-15 03:14:29.279891 (MainThread): Parsing macros\core.sql
2020-07-15 03:14:29.284847 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 03:14:29.335712 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 03:14:29.347679 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 03:14:29.350671 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 03:14:29.352666 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 03:14:29.355657 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 03:14:29.357652 (MainThread): Parsing macros\etc\query.sql
2020-07-15 03:14:29.359648 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 03:14:29.368623 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 03:14:29.383583 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 03:14:29.385577 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 03:14:29.392568 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 03:14:29.415499 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 03:14:29.445453 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 03:14:29.448410 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 03:14:29.466375 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 03:14:29.474341 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 03:14:29.480324 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 03:14:29.487306 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 03:14:29.490298 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 03:14:29.491327 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 03:14:29.493333 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 03:14:29.496665 (MainThread): Parsing macros\adapters.sql
2020-07-15 03:14:29.514619 (MainThread): Parsing macros\catalog.sql
2020-07-15 03:14:29.521600 (MainThread): Parsing macros\etc.sql
2020-07-15 03:14:29.522598 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 03:14:29.537558 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 03:14:29.539589 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 03:14:29.542544 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 03:14:29.554512 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 03:14:29.579445 (MainThread): Partial parsing not enabled
2020-07-15 03:14:29.614352 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:14:29.614352 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:14:29.643276 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:14:29.643276 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:14:29.653280 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:14:29.653280 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:14:29.981392 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 03:14:29.982498 (MainThread): 
2020-07-15 03:14:29.983499 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:14:29.983499 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:14:29.999470 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 03:14:29.999470 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 03:14:30.001449 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 03:14:30.636489 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:14:30.636489 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:14:30.636489 (MainThread): 00:14:30 | Concurrency: 1 threads (target='dev')
2020-07-15 03:14:30.637490 (MainThread): 00:14:30 | 
2020-07-15 03:14:30.647410 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:14:30.647410 (Thread-1): 00:14:30 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2020-07-15 03:14:30.647410 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-07-15 03:14:30.648447 (Thread-1): Opening a new connection, currently in state init
2020-07-15 03:14:30.648447 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:14:30.671390 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-07-15 03:14:30.675334 (Thread-1): finished collecting timing info
2020-07-15 03:14:30.677376 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */





with all_values as (

    select distinct
        status as value_field

    from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-15 03:14:32.370328 (Thread-1): finished collecting timing info
2020-07-15 03:14:32.372324 (Thread-1): 00:14:32 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.72s]
2020-07-15 03:14:32.374314 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:14:32.375308 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:14:32.376308 (Thread-1): 00:14:32 | 2 of 9 START test not_null_customers_customer_id..................... [RUN]
2020-07-15 03:14:32.378298 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-07-15 03:14:32.378298 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned).
2020-07-15 03:14:32.379297 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:14:32.399242 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-07-15 03:14:32.404227 (Thread-1): finished collecting timing info
2020-07-15 03:14:32.404227 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`customers`
where customer_id is null


2020-07-15 03:14:33.752115 (Thread-1): finished collecting timing info
2020-07-15 03:14:33.754111 (Thread-1): 00:14:33 | 2 of 9 PASS not_null_customers_customer_id........................... [PASS in 1.38s]
2020-07-15 03:14:33.757108 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:14:33.757108 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:14:33.758157 (Thread-1): 00:14:33 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2020-07-15 03:14:33.760094 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-07-15 03:14:33.761093 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id).
2020-07-15 03:14:33.761093 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:14:33.785079 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-07-15 03:14:33.790011 (Thread-1): finished collecting timing info
2020-07-15 03:14:33.790011 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
where customer_id is null


2020-07-15 03:14:35.035496 (Thread-1): finished collecting timing info
2020-07-15 03:14:35.036500 (Thread-1): 00:14:35 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 1.28s]
2020-07-15 03:14:35.037439 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:14:35.038489 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-07-15 03:14:35.038489 (Thread-1): 00:14:35 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2020-07-15 03:14:35.039649 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id".
2020-07-15 03:14:35.039649 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id).
2020-07-15 03:14:35.039649 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id
2020-07-15 03:14:35.058640 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id"
2020-07-15 03:14:35.064588 (Thread-1): finished collecting timing info
2020-07-15 03:14:35.065609 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
where customer_id is null


2020-07-15 03:14:36.116939 (Thread-1): finished collecting timing info
2020-07-15 03:14:36.118933 (Thread-1): 00:14:36 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 1.08s]
2020-07-15 03:14:36.120931 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-07-15 03:14:36.121924 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:14:36.121924 (Thread-1): 00:14:36 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2020-07-15 03:14:36.123963 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-07-15 03:14:36.123963 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_customer_id).
2020-07-15 03:14:36.123963 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:14:36.142892 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-07-15 03:14:36.152840 (Thread-1): finished collecting timing info
2020-07-15 03:14:36.152840 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
where order_id is null


2020-07-15 03:14:37.577062 (Thread-1): finished collecting timing info
2020-07-15 03:14:37.578124 (Thread-1): 00:14:37 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 1.46s]
2020-07-15 03:14:37.579063 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:14:37.579063 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-07-15 03:14:37.579063 (Thread-1): 00:14:37 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2020-07-15 03:14:37.579063 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2020-07-15 03:14:37.579063 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id).
2020-07-15 03:14:37.579063 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-07-15 03:14:37.588072 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"
2020-07-15 03:14:37.594029 (Thread-1): finished collecting timing info
2020-07-15 03:14:37.594029 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"} */





select count(*) as validation_errors
from (
    select customer_id as id from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
) as child
left join (
    select customer_id as id from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null


2020-07-15 03:14:39.004196 (Thread-1): finished collecting timing info
2020-07-15 03:14:39.006192 (Thread-1): 00:14:39 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 1.43s]
2020-07-15 03:14:39.009177 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-07-15 03:14:39.009177 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:14:39.010176 (Thread-1): 00:14:39 | 7 of 9 START test unique_customers_customer_id....................... [RUN]
2020-07-15 03:14:39.011209 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-07-15 03:14:39.011209 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_).
2020-07-15 03:14:39.012198 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:14:39.028163 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-07-15 03:14:39.034106 (Thread-1): finished collecting timing info
2020-07-15 03:14:39.034106 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `bigquery-dbt`.`dbt_lucas`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-07-15 03:14:40.302897 (Thread-1): finished collecting timing info
2020-07-15 03:14:40.304902 (Thread-1): 00:14:40 | 7 of 9 PASS unique_customers_customer_id............................. [PASS in 1.29s]
2020-07-15 03:14:40.306836 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:14:40.306836 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:14:40.307879 (Thread-1): 00:14:40 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2020-07-15 03:14:40.308831 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-07-15 03:14:40.309859 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id).
2020-07-15 03:14:40.309859 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:14:40.329770 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-07-15 03:14:40.334757 (Thread-1): finished collecting timing info
2020-07-15 03:14:40.334757 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-07-15 03:14:41.593774 (Thread-1): finished collecting timing info
2020-07-15 03:14:41.595767 (Thread-1): 00:14:41 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 1.29s]
2020-07-15 03:14:41.597712 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:14:41.598749 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:14:41.599702 (Thread-1): 00:14:41 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2020-07-15 03:14:41.600700 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-07-15 03:14:41.601739 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id).
2020-07-15 03:14:41.601739 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:14:41.621678 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-07-15 03:14:41.626625 (Thread-1): finished collecting timing info
2020-07-15 03:14:41.627656 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */




select count(*) as validation_errors
from (

    select
        order_id

    from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors


2020-07-15 03:14:43.174673 (Thread-1): finished collecting timing info
2020-07-15 03:14:43.174673 (Thread-1): 00:14:43 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 1.57s]
2020-07-15 03:14:43.176624 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:14:43.177620 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:14:43.177620 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:14:43.178650 (MainThread): 00:14:43 | 
2020-07-15 03:14:43.178650 (MainThread): 00:14:43 | Finished running 9 tests in 13.20s.
2020-07-15 03:14:43.179625 (MainThread): Connection 'master' was properly closed.
2020-07-15 03:14:43.179625 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 03:14:43.179625 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was left open.
2020-07-15 03:14:43.224494 (MainThread): 
2020-07-15 03:14:43.224494 (MainThread): Completed successfully
2020-07-15 03:14:43.225501 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2020-07-15 03:14:43.225501 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06E0E820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06B8DCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06B8DD00>]}
2020-07-15 03:14:43.225501 (MainThread): Flushing usage events
2020-07-15 03:17:20.621962 (MainThread): Running with dbt=0.17.0
2020-07-15 03:17:21.076870 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-07-15 03:17:21.078867 (MainThread): Tracking: tracking
2020-07-15 03:17:21.078867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x058C5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0653CAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0653C7D8>]}
2020-07-15 03:17:21.150266 (MainThread): Serving docs at 0.0.0.0:8080
2020-07-15 03:17:21.151218 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-07-15 03:17:21.151218 (MainThread): Press Ctrl+C to exit.


2020-07-15 03:18:17.559414 (MainThread): Flushing usage events
2020-07-15 03:18:17.799218 (MainThread): ctrl-c
2020-07-15 03:18:22.710104 (MainThread): Running with dbt=0.17.0
2020-07-15 03:18:23.181956 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-07-15 03:18:23.183906 (MainThread): Tracking: tracking
2020-07-15 03:18:23.183906 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x064D5D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07149A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x071498F8>]}
2020-07-15 03:18:23.222803 (MainThread): Serving docs at 0.0.0.0:8080
2020-07-15 03:18:23.223832 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-07-15 03:18:23.223832 (MainThread): Press Ctrl+C to exit.


2020-07-15 03:18:35.812193 (MainThread): Flushing usage events
2020-07-15 03:18:36.037218 (MainThread): ctrl-c
2020-07-15 03:18:39.427190 (MainThread): Running with dbt=0.17.0
2020-07-15 03:18:39.897875 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-07-15 03:18:39.899867 (MainThread): Tracking: tracking
2020-07-15 03:18:39.899867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05935DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065ADAA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AD7D8>]}
2020-07-15 03:18:39.939712 (MainThread): Serving docs at 0.0.0.0:8080
2020-07-15 03:18:39.939712 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-07-15 03:18:39.940709 (MainThread): Press Ctrl+C to exit.


2020-07-15 03:19:04.586256 (MainThread): Flushing usage events
2020-07-15 03:19:04.794234 (MainThread): ctrl-c
2020-07-15 03:19:41.930172 (MainThread): Running with dbt=0.17.0
2020-07-15 03:19:42.416190 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 03:19:42.418047 (MainThread): Tracking: tracking
2020-07-15 03:19:42.418047 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05935E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AA718>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065AA8B0>]}
2020-07-15 03:19:42.441983 (MainThread): Partial parsing not enabled
2020-07-15 03:19:42.449962 (MainThread): Parsing macros\core.sql
2020-07-15 03:19:42.453998 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 03:19:42.506314 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 03:19:42.516290 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 03:19:42.518286 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 03:19:42.520280 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 03:19:42.523271 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 03:19:42.525267 (MainThread): Parsing macros\etc\query.sql
2020-07-15 03:19:42.527261 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 03:19:42.535273 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 03:19:42.551236 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 03:19:42.554190 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 03:19:42.561169 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 03:19:42.584109 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 03:19:42.614300 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 03:19:42.616997 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 03:19:42.634951 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 03:19:42.641967 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 03:19:42.647952 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 03:19:42.653939 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 03:19:42.656901 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 03:19:42.658888 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 03:19:42.660916 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 03:19:42.663874 (MainThread): Parsing macros\adapters.sql
2020-07-15 03:19:42.681826 (MainThread): Parsing macros\catalog.sql
2020-07-15 03:19:42.688807 (MainThread): Parsing macros\etc.sql
2020-07-15 03:19:42.689805 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 03:19:42.703806 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 03:19:42.706759 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 03:19:42.708785 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 03:19:42.719725 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 03:19:42.745655 (MainThread): Partial parsing not enabled
2020-07-15 03:19:42.780598 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:19:42.780598 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:19:42.809523 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:19:42.810520 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:19:42.820490 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:19:42.820490 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:19:43.111054 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 03:19:43.111054 (MainThread): 
2020-07-15 03:19:43.112051 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:19:43.112051 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:19:43.117037 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 03:19:43.117037 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 03:19:43.686229 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 03:19:43.686229 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 03:19:43.687188 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 03:19:44.119892 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:19:44.119892 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:19:44.120926 (MainThread): 00:19:44 | Concurrency: 1 threads (target='dev')
2020-07-15 03:19:44.121327 (MainThread): 00:19:44 | 
2020-07-15 03:19:44.131305 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 03:19:44.133332 (Thread-1): 00:19:44 | 1 of 3 START view model dbt_lucas.stg_customers...................... [RUN]
2020-07-15 03:19:44.133332 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:19:44.134297 (Thread-1): Opening a new connection, currently in state init
2020-07-15 03:19:44.134297 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 03:19:44.157237 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 03:19:44.162221 (Thread-1): finished collecting timing info
2020-07-15 03:19:44.189187 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 03:19:44.195013 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-07-15 03:19:45.494493 (Thread-1): finished collecting timing info
2020-07-15 03:19:45.495491 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0cf89f-b5c0-4d86-94d6-27e1c49e1c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067CC580>]}
2020-07-15 03:19:45.497485 (Thread-1): 00:19:45 | 1 of 3 OK created view model dbt_lucas.stg_customers................. [CREATE VIEW in 1.36s]
2020-07-15 03:19:45.498967 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 03:19:45.498967 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 03:19:45.500014 (Thread-1): 00:19:45 | 2 of 3 START view model dbt_lucas.stg_orders......................... [RUN]
2020-07-15 03:19:45.500964 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:19:45.500964 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers).
2020-07-15 03:19:45.500964 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 03:19:45.508987 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 03:19:45.512934 (Thread-1): finished collecting timing info
2020-07-15 03:19:45.516960 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 03:19:45.520911 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-07-15 03:19:46.577360 (Thread-1): finished collecting timing info
2020-07-15 03:19:46.578358 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0cf89f-b5c0-4d86-94d6-27e1c49e1c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067CC580>]}
2020-07-15 03:19:46.580352 (Thread-1): 00:19:46 | 2 of 3 OK created view model dbt_lucas.stg_orders.................... [CREATE VIEW in 1.08s]
2020-07-15 03:19:46.581346 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 03:19:46.582346 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 03:19:46.584340 (Thread-1): 00:19:46 | 3 of 3 START table model dbt_lucas.customers......................... [RUN]
2020-07-15 03:19:46.585125 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:19:46.585125 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_orders).
2020-07-15 03:19:46.585125 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 03:19:46.597134 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 03:19:46.602084 (Thread-1): finished collecting timing info
2020-07-15 03:19:46.619074 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 03:19:46.808946 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-07-15 03:19:46.813887 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `bigquery-dbt`.`dbt_lucas`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_customers`

),

orders as (

    select * from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-07-15 03:19:49.541758 (Thread-1): finished collecting timing info
2020-07-15 03:19:49.543764 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff0cf89f-b5c0-4d86-94d6-27e1c49e1c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066CCD00>]}
2020-07-15 03:19:49.547749 (Thread-1): 00:19:49 | 3 of 3 OK created table model dbt_lucas.customers.................... [CREATE TABLE (100) in 2.96s]
2020-07-15 03:19:49.549686 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 03:19:49.551677 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:19:49.551677 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:19:49.552728 (MainThread): 00:19:49 | 
2020-07-15 03:19:49.553672 (MainThread): 00:19:49 | Finished running 2 view models, 1 table model in 6.44s.
2020-07-15 03:19:49.553672 (MainThread): Connection 'master' was properly closed.
2020-07-15 03:19:49.553672 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 03:19:49.554670 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 03:19:49.554670 (MainThread): Connection 'model.jaffle_shop.customers' was left open.
2020-07-15 03:19:49.581598 (MainThread): 
2020-07-15 03:19:49.581598 (MainThread): Completed successfully
2020-07-15 03:19:49.582597 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-07-15 03:19:49.582597 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066CCD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x073ACF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0682DA00>]}
2020-07-15 03:19:49.582597 (MainThread): Flushing usage events
2020-07-15 03:19:54.333589 (MainThread): Running with dbt=0.17.0
2020-07-15 03:19:54.809886 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-07-15 03:19:54.811913 (MainThread): Tracking: tracking
2020-07-15 03:19:54.812880 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05D95DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06A0DAD8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06A0D928>]}
2020-07-15 03:19:54.850778 (MainThread): Serving docs at 0.0.0.0:8080
2020-07-15 03:19:54.850778 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-07-15 03:19:54.850778 (MainThread): Press Ctrl+C to exit.


2020-07-15 03:20:03.449443 (MainThread): Flushing usage events
2020-07-15 03:20:03.663694 (MainThread): ctrl-c
2020-07-15 03:24:46.948477 (MainThread): Running with dbt=0.17.0
2020-07-15 03:24:47.451987 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-07-15 03:24:47.453930 (MainThread): Tracking: tracking
2020-07-15 03:24:47.453930 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06025DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C9C778>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06C9C868>]}
2020-07-15 03:24:47.476869 (MainThread): Partial parsing not enabled
2020-07-15 03:24:47.485129 (MainThread): Parsing macros\core.sql
2020-07-15 03:24:47.490114 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 03:24:47.541166 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 03:24:47.551208 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 03:24:47.553136 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 03:24:47.555161 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 03:24:47.557156 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 03:24:47.560201 (MainThread): Parsing macros\etc\query.sql
2020-07-15 03:24:47.561147 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 03:24:47.570091 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 03:24:47.587045 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 03:24:47.590037 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 03:24:47.598065 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 03:24:47.620955 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 03:24:47.649880 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 03:24:47.651872 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 03:24:47.669824 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 03:24:47.676835 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 03:24:47.682789 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 03:24:47.689771 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 03:24:47.691822 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 03:24:47.693761 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 03:24:47.695754 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 03:24:47.699743 (MainThread): Parsing macros\adapters.sql
2020-07-15 03:24:47.716729 (MainThread): Parsing macros\catalog.sql
2020-07-15 03:24:47.722683 (MainThread): Parsing macros\etc.sql
2020-07-15 03:24:47.723712 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 03:24:47.736644 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 03:24:47.739637 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 03:24:47.741668 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 03:24:47.752602 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 03:24:47.776532 (MainThread): Partial parsing not enabled
2020-07-15 03:24:47.811441 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:24:47.811441 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:24:47.841360 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:24:47.841360 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:24:47.852332 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:24:47.852332 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:24:48.135842 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 03:24:48.136632 (MainThread): 
2020-07-15 03:24:48.137632 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:24:48.137632 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:24:48.142619 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 03:24:48.142619 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 03:24:48.643834 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 03:24:48.643834 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 03:24:48.644850 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 03:24:49.183665 (MainThread): 00:24:49 | Concurrency: 1 threads (target='dev')
2020-07-15 03:24:49.183665 (MainThread): 00:24:49 | 
2020-07-15 03:24:49.193795 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 03:24:49.193795 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:24:49.194847 (Thread-1): Opening a new connection, currently in state init
2020-07-15 03:24:49.194847 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 03:24:49.221765 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 03:24:49.225713 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.226710 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.226710 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 03:24:49.226710 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 03:24:49.226710 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:24:49.226710 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.226710 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 03:24:49.232728 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 03:24:49.235686 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.236683 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.236683 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 03:24:49.236683 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:24:49.237680 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-07-15 03:24:49.237680 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.237680 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:24:49.250678 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-07-15 03:24:49.254636 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.254636 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.254636 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:24:49.254636 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:24:49.254636 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-07-15 03:24:49.255633 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.255633 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:24:49.263649 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-07-15 03:24:49.267614 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.267614 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.268664 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:24:49.268664 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 03:24:49.268664 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:24:49.268664 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.268664 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 03:24:49.276641 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 03:24:49.281579 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.281579 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.281579 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 03:24:49.282615 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:24:49.282615 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-07-15 03:24:49.282615 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.282615 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:24:49.292549 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-07-15 03:24:49.296539 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.296539 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.296539 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:24:49.296539 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:24:49.296539 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-07-15 03:24:49.297583 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.297583 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:24:49.304517 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-07-15 03:24:49.308900 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.308900 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.308900 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:24:49.308900 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:24:49.309897 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-07-15 03:24:49.309897 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.309897 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:24:49.316910 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-07-15 03:24:49.319871 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.320868 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.320868 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:24:49.320868 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:24:49.320868 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-07-15 03:24:49.321866 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.321866 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:24:49.328872 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-07-15 03:24:49.331839 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.332836 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.332836 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:24:49.333833 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:24:49.333833 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-07-15 03:24:49.333833 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:24:49.333833 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:24:49.341839 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-07-15 03:24:49.344803 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.344803 (Thread-1): finished collecting timing info
2020-07-15 03:24:49.345833 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:24:49.345833 (MainThread): Connection 'master' was properly closed.
2020-07-15 03:24:49.345833 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 03:24:49.346798 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 03:24:49.346798 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2020-07-15 03:24:49.378353 (MainThread): 00:24:49 | Done.
2020-07-15 03:24:49.412253 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-07-15 03:24:49.412253 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:24:49.412253 (MainThread): 00:24:49 | Building catalog
2020-07-15 03:24:49.811885 (ThreadPoolExecutor-2_0): Acquiring new bigquery connection "bigquery-dbt.information_schema".
2020-07-15 03:24:49.812884 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-07-15 03:24:49.843829 (ThreadPoolExecutor-2_0): On bigquery-dbt.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "bigquery-dbt.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `bigquery-dbt`.`dbt_lucas`.__TABLES__
        where (upper(dataset_id) = upper('dbt_lucas'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,
            cast(null as string) as column_comment,

            is_partitioning_column,
            clustering_ordinal_position

        from `bigquery-dbt`.`dbt_lucas`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name

        from `bigquery-dbt`.`dbt_lucas`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS
        where data_type not like 'STRUCT%'

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-07-15 03:24:53.202405 (MainThread): 00:24:53 | Catalog written to D:\lucas\Freela\DBT\dbt-tutorial\target\catalog.json
2020-07-15 03:24:53.202405 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06025DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07A9B088>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x07A9B7F0>]}
2020-07-15 03:24:53.202405 (MainThread): Flushing usage events
2020-07-15 03:24:53.410866 (MainThread): Connection 'generate_catalog' was left open.
2020-07-15 03:24:53.410866 (MainThread): Connection 'bigquery-dbt.information_schema' was left open.
2020-07-15 03:26:27.487772 (MainThread): Running with dbt=0.17.0
2020-07-15 03:26:27.949099 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-07-15 03:26:27.951093 (MainThread): Tracking: tracking
2020-07-15 03:26:27.951093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05F75D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06BEAA60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06BEA8F8>]}
2020-07-15 03:26:27.988192 (MainThread): Serving docs at 0.0.0.0:8080
2020-07-15 03:26:27.988192 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-07-15 03:26:27.989166 (MainThread): Press Ctrl+C to exit.


2020-07-15 03:36:33.164374 (MainThread): Flushing usage events
2020-07-15 03:36:33.439770 (MainThread): ctrl-c
2020-07-15 03:36:44.141578 (MainThread): Running with dbt=0.17.0
2020-07-15 03:36:44.628674 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-15 03:36:44.630670 (MainThread): Tracking: tracking
2020-07-15 03:36:44.630670 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05835DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x064AB838>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x064AB880>]}
2020-07-15 03:36:44.652611 (MainThread): Partial parsing not enabled
2020-07-15 03:36:44.663582 (MainThread): Parsing macros\core.sql
2020-07-15 03:36:44.667862 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 03:36:44.720780 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 03:36:44.730696 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 03:36:44.731719 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 03:36:44.734685 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 03:36:44.736680 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 03:36:44.738721 (MainThread): Parsing macros\etc\query.sql
2020-07-15 03:36:44.740670 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 03:36:44.749658 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 03:36:44.768650 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 03:36:44.770633 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 03:36:44.778568 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 03:36:44.801507 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 03:36:44.832424 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 03:36:44.834419 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 03:36:44.852371 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 03:36:44.861346 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 03:36:44.866334 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 03:36:44.873362 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 03:36:44.876313 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 03:36:44.878301 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 03:36:44.879298 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 03:36:44.882372 (MainThread): Parsing macros\adapters.sql
2020-07-15 03:36:44.900147 (MainThread): Parsing macros\catalog.sql
2020-07-15 03:36:44.908140 (MainThread): Parsing macros\etc.sql
2020-07-15 03:36:44.910123 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 03:36:44.923088 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 03:36:44.927080 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 03:36:44.930070 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 03:36:44.941040 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 03:36:44.966971 (MainThread): Partial parsing not enabled
2020-07-15 03:36:45.006865 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:36:45.006865 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:36:45.034822 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:36:45.034822 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:36:45.045761 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:36:45.045761 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:36:45.337005 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 03:36:45.337005 (MainThread): 
2020-07-15 03:36:45.338033 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:36:45.338033 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:36:45.350970 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 03:36:45.350970 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 03:36:45.352962 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 03:36:46.006126 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:36:46.007075 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:36:46.007075 (MainThread): 00:36:46 | Concurrency: 1 threads (target='dev')
2020-07-15 03:36:46.007075 (MainThread): 00:36:46 | 
2020-07-15 03:36:46.016048 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned
2020-07-15 03:36:46.017072 (Thread-1): 00:36:46 | 1 of 7 START test accepted_values_stg_orders_status__shipped__completed__return_pending__returned [RUN]
2020-07-15 03:36:46.017072 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned".
2020-07-15 03:36:46.017072 (Thread-1): Opening a new connection, currently in state init
2020-07-15 03:36:46.017072 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned
2020-07-15 03:36:46.042977 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned"
2020-07-15 03:36:46.046966 (Thread-1): finished collecting timing info
2020-07-15 03:36:46.047964 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned"} */





with all_values as (

    select distinct
        status as value_field

    from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-15 03:36:47.952714 (Thread-1): finished collecting timing info
2020-07-15 03:36:47.954708 (Thread-1): 00:36:47 | 1 of 7 FAIL 1 accepted_values_stg_orders_status__shipped__completed__return_pending__returned [FAIL 1 in 1.94s]
2020-07-15 03:36:47.956705 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned
2020-07-15 03:36:47.958699 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:36:47.959698 (Thread-1): 00:36:47 | 2 of 7 START test not_null_customers_customer_id..................... [RUN]
2020-07-15 03:36:47.962688 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-07-15 03:36:47.962688 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__shipped__completed__return_pending__returned).
2020-07-15 03:36:47.963684 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:36:47.982631 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-07-15 03:36:47.989614 (Thread-1): finished collecting timing info
2020-07-15 03:36:47.990611 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`customers`
where customer_id is null


2020-07-15 03:36:49.437437 (Thread-1): finished collecting timing info
2020-07-15 03:36:49.439430 (Thread-1): 00:36:49 | 2 of 7 PASS not_null_customers_customer_id........................... [PASS in 1.48s]
2020-07-15 03:36:49.441383 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:36:49.442436 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:36:49.443378 (Thread-1): 00:36:49 | 3 of 7 START test not_null_stg_customers_customer_id................. [RUN]
2020-07-15 03:36:49.444383 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-07-15 03:36:49.445373 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id).
2020-07-15 03:36:49.446412 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:36:49.466347 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-07-15 03:36:49.470302 (Thread-1): finished collecting timing info
2020-07-15 03:36:49.470302 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
where customer_id is null


2020-07-15 03:36:50.844198 (Thread-1): finished collecting timing info
2020-07-15 03:36:50.845194 (Thread-1): 00:36:50 | 3 of 7 PASS not_null_stg_customers_customer_id....................... [PASS in 1.40s]
2020-07-15 03:36:50.846160 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:36:50.846160 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:36:50.846160 (Thread-1): 00:36:50 | 4 of 7 START test not_null_stg_orders_order_id....................... [RUN]
2020-07-15 03:36:50.847193 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-07-15 03:36:50.847193 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id).
2020-07-15 03:36:50.847193 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:36:50.856170 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-07-15 03:36:50.860506 (Thread-1): finished collecting timing info
2020-07-15 03:36:50.860506 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
where order_id is null


2020-07-15 03:36:52.217800 (Thread-1): finished collecting timing info
2020-07-15 03:36:52.219786 (Thread-1): 00:36:52 | 4 of 7 PASS not_null_stg_orders_order_id............................. [PASS in 1.37s]
2020-07-15 03:36:52.222776 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:36:52.222776 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:36:52.223774 (Thread-1): 00:36:52 | 5 of 7 START test unique_customers_customer_id....................... [RUN]
2020-07-15 03:36:52.224772 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-07-15 03:36:52.224772 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id).
2020-07-15 03:36:52.224772 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:36:52.242721 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-07-15 03:36:52.246712 (Thread-1): finished collecting timing info
2020-07-15 03:36:52.247709 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `bigquery-dbt`.`dbt_lucas`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-07-15 03:36:53.566857 (Thread-1): finished collecting timing info
2020-07-15 03:36:53.568841 (Thread-1): 00:36:53 | 5 of 7 PASS unique_customers_customer_id............................. [PASS in 1.35s]
2020-07-15 03:36:53.570721 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:36:53.571728 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:36:53.572729 (Thread-1): 00:36:53 | 6 of 7 START test unique_stg_customers_customer_id................... [RUN]
2020-07-15 03:36:53.574720 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-07-15 03:36:53.574720 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id).
2020-07-15 03:36:53.575716 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:36:53.600648 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-07-15 03:36:53.605634 (Thread-1): finished collecting timing info
2020-07-15 03:36:53.605634 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-07-15 03:36:55.071552 (Thread-1): finished collecting timing info
2020-07-15 03:36:55.072549 (Thread-1): 00:36:55 | 6 of 7 PASS unique_stg_customers_customer_id......................... [PASS in 1.50s]
2020-07-15 03:36:55.073546 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:36:55.073546 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:36:55.073546 (Thread-1): 00:36:55 | 7 of 7 START test unique_stg_orders_order_id......................... [RUN]
2020-07-15 03:36:55.073546 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-07-15 03:36:55.073546 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id).
2020-07-15 03:36:55.073546 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:36:55.084519 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-07-15 03:36:55.088507 (Thread-1): finished collecting timing info
2020-07-15 03:36:55.089529 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */




select count(*) as validation_errors
from (

    select
        order_id

    from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors


2020-07-15 03:36:56.436409 (Thread-1): finished collecting timing info
2020-07-15 03:36:56.437410 (Thread-1): 00:36:56 | 7 of 7 PASS unique_stg_orders_order_id............................... [PASS in 1.36s]
2020-07-15 03:36:56.438369 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:36:56.439369 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:36:56.439369 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:36:56.439369 (MainThread): 00:36:56 | 
2020-07-15 03:36:56.439369 (MainThread): 00:36:56 | Finished running 7 tests in 11.10s.
2020-07-15 03:36:56.439369 (MainThread): Connection 'master' was properly closed.
2020-07-15 03:36:56.439369 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 03:36:56.440366 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was left open.
2020-07-15 03:36:56.469325 (MainThread): 
2020-07-15 03:36:56.469325 (MainThread): Completed with 1 error and 0 warnings:
2020-07-15 03:36:56.470285 (MainThread): 
2020-07-15 03:36:56.470285 (MainThread): Failure in test accepted_values_stg_orders_status__shipped__completed__return_pending__returned (models\schema.yml)
2020-07-15 03:36:56.470285 (MainThread):   Got 1 result, expected 0.
2020-07-15 03:36:56.470285 (MainThread): 
2020-07-15 03:36:56.470285 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\accepted_values_stg_orders_e7af5fd4bf1cbc933941451dab4020b6.sql
2020-07-15 03:36:56.471283 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2020-07-15 03:36:56.471283 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x066877C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06BC5730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06BC5B50>]}
2020-07-15 03:36:56.471283 (MainThread): Flushing usage events
2020-07-15 03:37:50.519090 (MainThread): Running with dbt=0.17.0
2020-07-15 03:37:51.004008 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-07-15 03:37:51.005973 (MainThread): Tracking: tracking
2020-07-15 03:37:51.005973 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05945DA8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065BC868>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x065BC760>]}
2020-07-15 03:37:51.029909 (MainThread): Partial parsing not enabled
2020-07-15 03:37:51.036911 (MainThread): Parsing macros\core.sql
2020-07-15 03:37:51.041873 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 03:37:51.093734 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 03:37:51.102710 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 03:37:51.104705 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 03:37:51.106699 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 03:37:51.108719 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 03:37:51.111687 (MainThread): Parsing macros\etc\query.sql
2020-07-15 03:37:51.112685 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 03:37:51.122696 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 03:37:51.137617 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 03:37:51.139648 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 03:37:51.147591 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 03:37:51.172524 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 03:37:51.204438 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 03:37:51.206475 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 03:37:51.225382 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 03:37:51.233390 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 03:37:51.238382 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 03:37:51.246327 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 03:37:51.248322 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 03:37:51.250317 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 03:37:51.252340 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 03:37:51.255303 (MainThread): Parsing macros\adapters.sql
2020-07-15 03:37:51.273254 (MainThread): Parsing macros\catalog.sql
2020-07-15 03:37:51.279286 (MainThread): Parsing macros\etc.sql
2020-07-15 03:37:51.281233 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 03:37:51.296193 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 03:37:51.298188 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 03:37:51.301180 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 03:37:51.313148 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 03:37:51.340122 (MainThread): Partial parsing not enabled
2020-07-15 03:37:51.377975 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:37:51.377975 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:37:51.406929 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:37:51.406929 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:37:51.418865 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:37:51.418865 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:37:51.715383 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 03:37:51.716415 (MainThread): 
2020-07-15 03:37:51.716415 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:37:51.716415 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:37:51.730342 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 03:37:51.730342 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 03:37:51.731341 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 03:37:52.226979 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:37:52.226979 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:37:52.228012 (MainThread): 00:37:52 | Concurrency: 1 threads (target='dev')
2020-07-15 03:37:52.228012 (MainThread): 00:37:52 | 
2020-07-15 03:37:52.234954 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:37:52.236973 (Thread-1): 00:37:52 | 1 of 7 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2020-07-15 03:37:52.236973 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-07-15 03:37:52.236973 (Thread-1): Opening a new connection, currently in state init
2020-07-15 03:37:52.236973 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:37:52.257926 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-07-15 03:37:52.262878 (Thread-1): finished collecting timing info
2020-07-15 03:37:52.263883 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */





with all_values as (

    select distinct
        status as value_field

    from `bigquery-dbt`.`dbt_lucas`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors


2020-07-15 03:37:53.826978 (Thread-1): finished collecting timing info
2020-07-15 03:37:53.828000 (Thread-1): 00:37:53 | 1 of 7 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 1.59s]
2020-07-15 03:37:53.828000 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:37:53.828000 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:37:53.828971 (Thread-1): 00:37:53 | 2 of 7 START test not_null_customers_customer_id..................... [RUN]
2020-07-15 03:37:53.828971 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-07-15 03:37:53.828971 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned).
2020-07-15 03:37:53.828971 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:37:53.840941 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-07-15 03:37:53.844929 (Thread-1): finished collecting timing info
2020-07-15 03:37:53.844929 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`customers`
where customer_id is null


2020-07-15 03:37:54.859508 (Thread-1): finished collecting timing info
2020-07-15 03:37:54.861440 (Thread-1): 00:37:54 | 2 of 7 PASS not_null_customers_customer_id........................... [PASS in 1.03s]
2020-07-15 03:37:54.862557 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:37:54.862557 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:37:54.862557 (Thread-1): 00:37:54 | 3 of 7 START test not_null_stg_customers_customer_id................. [RUN]
2020-07-15 03:37:54.862557 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-07-15 03:37:54.862557 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_customers_customer_id).
2020-07-15 03:37:54.862557 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:37:54.871592 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-07-15 03:37:54.875561 (Thread-1): finished collecting timing info
2020-07-15 03:37:54.876523 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
where customer_id is null


2020-07-15 03:37:56.040853 (Thread-1): finished collecting timing info
2020-07-15 03:37:56.041888 (Thread-1): 00:37:56 | 3 of 7 PASS not_null_stg_customers_customer_id....................... [PASS in 1.18s]
2020-07-15 03:37:56.043840 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:37:56.043840 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:37:56.044868 (Thread-1): 00:37:56 | 4 of 7 START test not_null_stg_orders_order_id....................... [RUN]
2020-07-15 03:37:56.045835 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-07-15 03:37:56.045835 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_customers_customer_id).
2020-07-15 03:37:56.046862 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:37:56.067780 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-07-15 03:37:56.074755 (Thread-1): finished collecting timing info
2020-07-15 03:37:56.075787 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */




select count(*) as validation_errors
from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
where order_id is null


2020-07-15 03:37:57.223496 (Thread-1): finished collecting timing info
2020-07-15 03:37:57.223496 (Thread-1): 00:37:57 | 4 of 7 PASS not_null_stg_orders_order_id............................. [PASS in 1.18s]
2020-07-15 03:37:57.225225 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:37:57.225225 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:37:57.225225 (Thread-1): 00:37:57 | 5 of 7 START test unique_customers_customer_id....................... [RUN]
2020-07-15 03:37:57.226224 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-07-15 03:37:57.226224 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.not_null_stg_orders_order_id).
2020-07-15 03:37:57.226224 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:37:57.233240 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-07-15 03:37:57.240188 (Thread-1): finished collecting timing info
2020-07-15 03:37:57.240188 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `bigquery-dbt`.`dbt_lucas`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-07-15 03:37:58.229897 (Thread-1): finished collecting timing info
2020-07-15 03:37:58.229897 (Thread-1): 00:37:58 | 5 of 7 PASS unique_customers_customer_id............................. [PASS in 1.00s]
2020-07-15 03:37:58.230894 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:37:58.230894 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:37:58.231891 (Thread-1): 00:37:58 | 6 of 7 START test unique_stg_customers_customer_id................... [RUN]
2020-07-15 03:37:58.231891 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-07-15 03:37:58.231891 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.unique_customers_customer_id).
2020-07-15 03:37:58.231891 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:37:58.241864 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-07-15 03:37:58.246851 (Thread-1): finished collecting timing info
2020-07-15 03:37:58.246851 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */




select count(*) as validation_errors
from (

    select
        customer_id

    from `bigquery-dbt`.`dbt_lucas`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors


2020-07-15 03:37:59.176733 (Thread-1): finished collecting timing info
2020-07-15 03:37:59.178727 (Thread-1): 00:37:59 | 6 of 7 PASS unique_stg_customers_customer_id......................... [PASS in 0.95s]
2020-07-15 03:37:59.181684 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:37:59.181684 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:37:59.182681 (Thread-1): 00:37:59 | 7 of 7 START test unique_stg_orders_order_id......................... [RUN]
2020-07-15 03:37:59.184673 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-07-15 03:37:59.185679 (Thread-1): Re-using an available connection from the pool (formerly test.jaffle_shop.unique_stg_customers_customer_id).
2020-07-15 03:37:59.185679 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:37:59.206643 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-07-15 03:37:59.211595 (Thread-1): finished collecting timing info
2020-07-15 03:37:59.212591 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */




select count(*) as validation_errors
from (

    select
        order_id

    from `bigquery-dbt`.`dbt_lucas`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors


2020-07-15 03:38:00.454394 (Thread-1): finished collecting timing info
2020-07-15 03:38:00.454394 (Thread-1): 00:38:00 | 7 of 7 PASS unique_stg_orders_order_id............................... [PASS in 1.27s]
2020-07-15 03:38:00.455765 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:38:00.456756 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:38:00.456756 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:38:00.456756 (MainThread): 00:38:00 | 
2020-07-15 03:38:00.456756 (MainThread): 00:38:00 | Finished running 7 tests in 8.74s.
2020-07-15 03:38:00.457798 (MainThread): Connection 'master' was properly closed.
2020-07-15 03:38:00.457798 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 03:38:00.457798 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was left open.
2020-07-15 03:38:00.485727 (MainThread): 
2020-07-15 03:38:00.486724 (MainThread): Completed successfully
2020-07-15 03:38:00.486724 (MainThread): 
Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
2020-07-15 03:38:00.486724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06CD5700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06CD5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06CD5838>]}
2020-07-15 03:38:00.487721 (MainThread): Flushing usage events
2020-07-15 03:38:29.943101 (MainThread): Running with dbt=0.17.0
2020-07-15 03:38:30.435683 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['staging'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-07-15 03:38:30.437646 (MainThread): Tracking: tracking
2020-07-15 03:38:30.437646 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05B65D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067DE820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x067DE7A8>]}
2020-07-15 03:38:30.460579 (MainThread): Partial parsing not enabled
2020-07-15 03:38:30.467560 (MainThread): Parsing macros\core.sql
2020-07-15 03:38:30.472547 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 03:38:30.525407 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 03:38:30.534415 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 03:38:30.536376 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 03:38:30.538404 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 03:38:30.541363 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 03:38:30.543371 (MainThread): Parsing macros\etc\query.sql
2020-07-15 03:38:30.545353 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 03:38:30.553330 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 03:38:30.568291 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 03:38:30.572280 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 03:38:30.579263 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 03:38:30.601211 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 03:38:30.630160 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 03:38:30.633119 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 03:38:30.653101 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 03:38:30.661043 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 03:38:30.667027 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 03:38:30.674042 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 03:38:30.677000 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 03:38:30.678030 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 03:38:30.679996 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 03:38:30.683023 (MainThread): Parsing macros\adapters.sql
2020-07-15 03:38:30.701934 (MainThread): Parsing macros\catalog.sql
2020-07-15 03:38:30.709943 (MainThread): Parsing macros\etc.sql
2020-07-15 03:38:30.710944 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 03:38:30.725901 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 03:38:30.728920 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 03:38:30.731855 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 03:38:30.742862 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 03:38:30.767818 (MainThread): Partial parsing not enabled
2020-07-15 03:38:30.805719 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:38:30.805719 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:38:30.833669 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:38:30.834677 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:38:30.847632 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:38:30.847632 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:38:31.140844 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 03:38:31.141840 (MainThread): 
2020-07-15 03:38:31.142837 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:38:31.142837 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:38:31.146826 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 03:38:31.146826 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 03:38:31.705892 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 03:38:31.705892 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 03:38:31.707885 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 03:38:32.068333 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:38:32.068333 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:38:32.069308 (MainThread): 00:38:32 | Concurrency: 1 threads (target='dev')
2020-07-15 03:38:32.070287 (MainThread): 00:38:32 | 
2020-07-15 03:38:32.079272 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 03:38:32.080291 (Thread-1): 00:38:32 | 1 of 2 START view model dbt_lucas.stg_customers...................... [RUN]
2020-07-15 03:38:32.081254 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:38:32.081254 (Thread-1): Opening a new connection, currently in state init
2020-07-15 03:38:32.081254 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 03:38:32.106194 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 03:38:32.110177 (Thread-1): finished collecting timing info
2020-07-15 03:38:32.143124 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 03:38:32.148076 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`stg_customers`
  OPTIONS()
  as select
    id as customer_id,
    first_name,
    last_name

from `dbt-tutorial`.jaffle_shop.customers;


2020-07-15 03:38:33.375165 (Thread-1): finished collecting timing info
2020-07-15 03:38:33.376162 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33319de7-8e54-4aa3-a2e3-2bb3c9c39356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x069A02B0>]}
2020-07-15 03:38:33.378156 (Thread-1): 00:38:33 | 1 of 2 OK created view model dbt_lucas.stg_customers................. [CREATE VIEW in 1.30s]
2020-07-15 03:38:33.379152 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 03:38:33.379152 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 03:38:33.380151 (Thread-1): 00:38:33 | 2 of 2 START view model dbt_lucas.stg_orders......................... [RUN]
2020-07-15 03:38:33.381148 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:38:33.381148 (Thread-1): Re-using an available connection from the pool (formerly model.jaffle_shop.stg_customers).
2020-07-15 03:38:33.381148 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 03:38:33.389125 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 03:38:33.393115 (Thread-1): finished collecting timing info
2020-07-15 03:38:33.397104 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 03:38:33.403101 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `bigquery-dbt`.`dbt_lucas`.`stg_orders`
  OPTIONS()
  as select
    id as order_id,
    user_id as customer_id,
    order_date,
    status

from `dbt-tutorial`.jaffle_shop.orders;


2020-07-15 03:38:34.422060 (Thread-1): finished collecting timing info
2020-07-15 03:38:34.423067 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '33319de7-8e54-4aa3-a2e3-2bb3c9c39356', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06A0E2F8>]}
2020-07-15 03:38:34.425061 (Thread-1): 00:38:34 | 2 of 2 OK created view model dbt_lucas.stg_orders.................... [CREATE VIEW in 1.04s]
2020-07-15 03:38:34.426991 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 03:38:34.427992 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:38:34.427992 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:38:34.428992 (MainThread): 00:38:34 | 
2020-07-15 03:38:34.429699 (MainThread): 00:38:34 | Finished running 2 view models in 3.29s.
2020-07-15 03:38:34.429699 (MainThread): Connection 'master' was properly closed.
2020-07-15 03:38:34.429699 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 03:38:34.429699 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 03:38:34.429699 (MainThread): Connection 'model.jaffle_shop.stg_orders' was left open.
2020-07-15 03:38:34.445659 (MainThread): 
2020-07-15 03:38:34.445659 (MainThread): Completed successfully
2020-07-15 03:38:34.446656 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-07-15 03:38:34.446656 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06F0D1A8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06EEEFE8>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06EEE4A8>]}
2020-07-15 03:38:34.446656 (MainThread): Flushing usage events
2020-07-15 03:41:01.836116 (MainThread): Running with dbt=0.17.0
2020-07-15 03:41:02.304737 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', single_threaded=False, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-07-15 03:41:02.306731 (MainThread): Tracking: tracking
2020-07-15 03:41:02.307732 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05BA5D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0681C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0681C940>]}
2020-07-15 03:41:02.329934 (MainThread): Partial parsing not enabled
2020-07-15 03:41:02.337192 (MainThread): Parsing macros\core.sql
2020-07-15 03:41:02.342182 (MainThread): Parsing macros\adapters\common.sql
2020-07-15 03:41:02.391240 (MainThread): Parsing macros\etc\datetime.sql
2020-07-15 03:41:02.401216 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-07-15 03:41:02.402214 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-07-15 03:41:02.404247 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-07-15 03:41:02.407201 (MainThread): Parsing macros\etc\is_incremental.sql
2020-07-15 03:41:02.409195 (MainThread): Parsing macros\etc\query.sql
2020-07-15 03:41:02.411189 (MainThread): Parsing macros\materializations\helpers.sql
2020-07-15 03:41:02.418208 (MainThread): Parsing macros\materializations\common\merge.sql
2020-07-15 03:41:02.433131 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-07-15 03:41:02.435162 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-07-15 03:41:02.442108 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-07-15 03:41:02.464048 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-07-15 03:41:02.491974 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-07-15 03:41:02.494966 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-07-15 03:41:02.511921 (MainThread): Parsing macros\materializations\table\table.sql
2020-07-15 03:41:02.519900 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-07-15 03:41:02.524886 (MainThread): Parsing macros\materializations\view\view.sql
2020-07-15 03:41:02.531867 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-07-15 03:41:02.534859 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-07-15 03:41:02.535856 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-07-15 03:41:02.536894 (MainThread): Parsing macros\schema_tests\unique.sql
2020-07-15 03:41:02.540844 (MainThread): Parsing macros\adapters.sql
2020-07-15 03:41:02.557834 (MainThread): Parsing macros\catalog.sql
2020-07-15 03:41:02.563782 (MainThread): Parsing macros\etc.sql
2020-07-15 03:41:02.564819 (MainThread): Parsing macros\materializations\incremental.sql
2020-07-15 03:41:02.578741 (MainThread): Parsing macros\materializations\seed.sql
2020-07-15 03:41:02.581734 (MainThread): Parsing macros\materializations\snapshot.sql
2020-07-15 03:41:02.583728 (MainThread): Parsing macros\materializations\table.sql
2020-07-15 03:41:02.593733 (MainThread): Parsing macros\materializations\view.sql
2020-07-15 03:41:02.618669 (MainThread): Partial parsing not enabled
2020-07-15 03:41:02.651584 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:41:02.651584 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:41:02.678513 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:41:02.678513 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:41:02.688449 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:41:02.689446 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:41:02.967798 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 147 macros, 0 operations, 0 seed files, 0 sources
2020-07-15 03:41:02.968795 (MainThread): 
2020-07-15 03:41:02.968795 (MainThread): Acquiring new bigquery connection "master".
2020-07-15 03:41:02.968795 (MainThread): Opening a new connection, currently in state closed
2020-07-15 03:41:02.973781 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_bigquery-dbt".
2020-07-15 03:41:02.973781 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-07-15 03:41:03.563814 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_bigquery-dbt_dbt_lucas".
2020-07-15 03:41:03.563814 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-07-15 03:41:03.564849 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-07-15 03:41:04.080982 (MainThread): 00:41:04 | Concurrency: 1 threads (target='dev')
2020-07-15 03:41:04.081980 (MainThread): 00:41:04 | 
2020-07-15 03:41:04.086967 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-07-15 03:41:04.086967 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-07-15 03:41:04.087964 (Thread-1): Opening a new connection, currently in state init
2020-07-15 03:41:04.087964 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-07-15 03:41:04.103922 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-07-15 03:41:04.107912 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.107912 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.108910 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-07-15 03:41:04.108910 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-07-15 03:41:04.109906 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-07-15 03:41:04.109906 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.109906 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-07-15 03:41:04.117885 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-07-15 03:41:04.121880 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.121880 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.122871 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-07-15 03:41:04.122871 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:41:04.122871 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-07-15 03:41:04.122871 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.123868 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:41:04.136833 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-07-15 03:41:04.139826 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.140825 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.140825 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-07-15 03:41:04.140825 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:41:04.140825 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-07-15 03:41:04.141820 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.141820 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:41:04.150796 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-07-15 03:41:04.153788 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.154787 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.154787 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-07-15 03:41:04.155784 (Thread-1): Began running node model.jaffle_shop.customers
2020-07-15 03:41:04.155784 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-07-15 03:41:04.155784 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.155784 (Thread-1): Compiling model.jaffle_shop.customers
2020-07-15 03:41:04.164786 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-07-15 03:41:04.168748 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.168748 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.169745 (Thread-1): Finished running node model.jaffle_shop.customers
2020-07-15 03:41:04.169745 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:41:04.169745 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-07-15 03:41:04.169745 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.170744 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:41:04.179720 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-07-15 03:41:04.183708 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.183708 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.184705 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-07-15 03:41:04.184705 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:41:04.184705 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-07-15 03:41:04.184705 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.185703 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:41:04.193682 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-07-15 03:41:04.196675 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.196675 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.196675 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-07-15 03:41:04.196675 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:41:04.197671 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-07-15 03:41:04.197671 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.197671 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:41:04.206647 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-07-15 03:41:04.209638 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.209638 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.210682 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-07-15 03:41:04.210682 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:41:04.210682 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-07-15 03:41:04.210682 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.210682 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:41:04.218616 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-07-15 03:41:04.223601 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.223601 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.224625 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-07-15 03:41:04.224625 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:41:04.224625 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-07-15 03:41:04.224625 (Thread-1): Opening a new connection, currently in state closed
2020-07-15 03:41:04.224625 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:41:04.233574 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-07-15 03:41:04.237564 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.237564 (Thread-1): finished collecting timing info
2020-07-15 03:41:04.238562 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-07-15 03:41:04.239560 (MainThread): Connection 'master' was properly closed.
2020-07-15 03:41:04.239560 (MainThread): Connection 'list_bigquery-dbt' was left open.
2020-07-15 03:41:04.239560 (MainThread): Connection 'list_bigquery-dbt_dbt_lucas' was left open.
2020-07-15 03:41:04.239560 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2020-07-15 03:41:04.273468 (MainThread): 00:41:04 | Done.
2020-07-15 03:41:04.311368 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-07-15 03:41:04.311368 (MainThread): Opening a new connection, currently in state init
2020-07-15 03:41:04.311368 (MainThread): 00:41:04 | Building catalog
2020-07-15 03:41:04.806839 (ThreadPoolExecutor-2_0): Acquiring new bigquery connection "bigquery-dbt.information_schema".
2020-07-15 03:41:04.807799 (ThreadPoolExecutor-2_0): Opening a new connection, currently in state init
2020-07-15 03:41:04.845687 (ThreadPoolExecutor-2_0): On bigquery-dbt.information_schema: /* {"app": "dbt", "dbt_version": "0.17.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "bigquery-dbt.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `bigquery-dbt`.`dbt_lucas`.__TABLES__
        where (upper(dataset_id) = upper('dbt_lucas'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,
            cast(null as string) as column_comment,

            is_partitioning_column,
            clustering_ordinal_position

        from `bigquery-dbt`.`dbt_lucas`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name

        from `bigquery-dbt`.`dbt_lucas`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS
        where data_type not like 'STRUCT%'

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-07-15 03:41:08.325488 (MainThread): 00:41:08 | Catalog written to D:\lucas\Freela\DBT\dbt-tutorial\target\catalog.json
2020-07-15 03:41:08.325488 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x05BA5D78>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06F2F6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06F2F550>]}
2020-07-15 03:41:08.326488 (MainThread): Flushing usage events
2020-07-15 03:41:08.578193 (MainThread): Connection 'generate_catalog' was left open.
2020-07-15 03:41:08.579184 (MainThread): Connection 'bigquery-dbt.information_schema' was left open.
2020-07-15 03:41:16.701384 (MainThread): Running with dbt=0.17.0
2020-07-15 03:41:17.160499 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\lmrosario\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, strict=False, target=None, test_new_parser=False, use_cache=True, vars='{}', warn_error=False, which='serve', write_json=True)
2020-07-15 03:41:17.162443 (MainThread): Tracking: tracking
2020-07-15 03:41:17.162443 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06155DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06DCEAC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x06DCE868>]}
2020-07-15 03:41:17.200341 (MainThread): Serving docs at 0.0.0.0:8080
2020-07-15 03:41:17.200341 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-07-15 03:41:17.200341 (MainThread): Press Ctrl+C to exit.


2020-07-15 04:44:16.735459 (MainThread): Flushing usage events
2020-07-15 04:44:17.027526 (MainThread): ctrl-c
